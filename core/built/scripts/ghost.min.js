!function(){"use strict";$.expr[":"].containsExact=function(a,b,c){return(a.textContent||a.innerText||$(a).text()||"")===c[3]},$.fn.center=function(a){var b=$(window),c=$.extend({animate:!0,successTrigger:"centered"},a);return this.each(function(){var a=$(this);a.css({position:"absolute"}),c.animate?a.animate({left:b.width()/2-a.outerWidth()/2+"px",top:b.height()/2-a.outerHeight()/2+"px"}):a.css({left:b.width()/2-a.outerWidth()/2+"px",top:b.height()/2-a.outerHeight()/2+"px"}),$(window).trigger(c.successTrigger)})},$.fn.transitionDuration=function(){var a=$(this);return a.css("transition-duration")?Math.round(1e3*parseFloat(this.css("transition-duration"))):this.css("-webkit-transition-duration")?Math.round(1e3*parseFloat(this.css("-webkit-transition-duration"))):this.css("-ms-transition-duration")?Math.round(1e3*parseFloat(this.css("-ms-transition-duration"))):this.css("-moz-transition-duration")?Math.round(1e3*parseFloat(this.css("-moz-transition-duration"))):this.css("-o-transition-duration")?Math.round(1e3*parseFloat(this.css("-o-transition-duration"))):0},$.fn.scrollClass=function(a){var b=$.extend({target:"","class-name":"scrolling",offset:1},a);return this.each(function(){var a=$(this),c=a;b.target&&(c=$(b.target)),a.scroll(function(){a.scrollTop()>b.offset?c.addClass(b["class-name"]):c.removeClass(b["class-name"])})})},$.fn.selectText=function(){var a,b,c=this[0];document.body.createTextRange?(a=document.body.createTextRange(),a.moveToElementText(c),a.select()):window.getSelection&&(b=window.getSelection(),a=document.createRange(),a.selectNodeContents(c),b.removeAllRanges(),b.addRange(a))},$.fn.hideAway=function(a){var b=$(this);return $("body").on("click",function(c){var d=$(c.target),e=b.selector;d.parents().is(e+":visible")||d.is(e+":visible")||(a?a($("body").find(e+":visible")):($("body").find(e+":visible").fadeOut(150),$("[data-toggle].active").removeClass("active")))}),this},$(".overlay").hideAway(),$.pluralize=function(a,b){var c=[a," ",b];return 1===a?c.join(""):c.concat("s").join("")}}(),function(a){"use strict";var b;b=function(b,c){var d='<div class="js-url"><input class="url js-upload-url" type="url" placeholder="http://"/></div>',e='<a class="image-cancel js-cancel" title="Delete"><span class="hidden">Delete</span></a>',f=a("<div />",{"class":"js-upload-progress progress progress-success active",role:"progressbar","aria-valuemin":"0","aria-valuemax":"100"}).append(a("<div />",{"class":"js-upload-progress-bar bar",style:"width:0%"}));a.extend(this,{complete:function(d){function e(c,d){b.find("img.js-upload-target").attr({width:c,height:d}).css({display:"block"}),b.find(".fileupload-loading").remove(),b.css({height:"auto"}),b.delay(250).animate({opacity:100},1e3,function(){a(".js-button-accept").prop("disabled",!1),i.init()})}function g(a){b.animate({opacity:0},250,function(){b.removeClass("image-uploader").addClass("pre-image-uploader"),b.css({minHeight:0}),i.removeExtras(),b.animate({height:a.height()},250,function(){e(a.width(),a.height())})})}function h(){var a=b.find("img.js-upload-target").attr({src:"",width:"auto",height:"auto"});f.animate({opacity:0},250,function(){b.find("span.media").after('<img class="fileupload-loading"  src="'+Ghost.paths.subdir+'/ghost/img/loadingcat.gif" />'),c.editor||f.find(".fileupload-loading").css({top:"56px"})}),b.trigger("uploadsuccess",[d]),a.one("load",function(){g(a)}).attr("src",d)}var i=this;h()},bindFileUpload:function(){var d=this;b.find(".js-fileupload").fileupload().fileupload("option",{url:Ghost.paths.subdir+"/ghost/upload/",headers:{"X-CSRF-Token":a("meta[name='csrf-param']").attr("content")},add:function(d,e){a(".js-button-accept").prop("disabled",!0),b.find(".js-fileupload").removeClass("right"),b.find(".js-url").remove(),f.find(".js-upload-progress-bar").removeClass("fail"),b.trigger("uploadstart",[b.attr("id")]),b.find("span.media, div.description, a.image-url, a.image-webcam").animate({opacity:0},250,function(){b.find("div.description").hide().css({opacity:100}),c.progressbar&&(b.find("div.js-fail").after(f),f.animate({opacity:100},250)),e.submit()})},dropZone:c.fileStorage?b:null,progressall:function(a,d){var e=parseInt(d.loaded/d.total*100,10);c.editor||f.find("div.js-progress").css({position:"absolute",top:"40px"}),c.progressbar&&(b.trigger("uploadprogress",[e,d]),f.find(".js-upload-progress-bar").css("width",e+"%"))},fail:function(c,e){a(".js-button-accept").prop("disabled",!1),b.trigger("uploadfailure",[e.result]),b.find(".js-upload-progress-bar").addClass("fail"),b.find("div.js-fail").text(413===e.jqXHR.status?"The image you uploaded was larger than the maximum file size your server allows.":415===e.jqXHR.status?"The image type you uploaded is not supported. Please use .PNG, .JPG, .GIF, .SVG.":"Something went wrong :("),b.find("div.js-fail, button.js-fail").fadeIn(1500),b.find("button.js-fail").on("click",function(){b.css({minHeight:0}),b.find("div.description").show(),d.removeExtras(),d.init()})},done:function(a,b){d.complete(b.result)}})},buildExtras:function(){b.find("span.media")[0]||b.prepend('<span class="media"><span class="hidden">Image Upload</span></span>'),b.find("div.description")[0]||b.append('<div class="description">Add image</div>'),b.find("div.js-fail")[0]||b.append('<div class="js-fail failed" style="display: none">Something went wrong :(</div>'),b.find("button.js-fail")[0]||b.append('<button class="js-fail button-add" style="display: none">Try Again</button>'),b.find("a.image-url")[0]||b.append('<a class="image-url" title="Add image from URL"><span class="hidden">URL</span></a>')},removeExtras:function(){b.find("span.media, div.js-upload-progress, a.image-url, a.image-upload, a.image-webcam, div.js-fail, button.js-fail, a.js-cancel").remove()},initWithDropzone:function(){var a=this;return b.find("img.js-upload-target").css({display:"none"}),b.removeClass("pre-image-uploader image-uploader-url").addClass("image-uploader"),this.removeExtras(),this.buildExtras(),this.bindFileUpload(),c.fileStorage?void b.find("a.image-url").on("click",function(){a.initUrl()}):void a.initUrl()},initUrl:function(){var a,f=this;this.removeExtras(),b.addClass("image-uploader-url").removeClass("pre-image-uploader"),b.find(".js-fileupload").addClass("right"),c.fileStorage&&b.append(e),b.find(".js-cancel").on("click",function(){b.find(".js-url").remove(),b.find(".js-fileupload").removeClass("right"),f.removeExtras(),f.initWithDropzone()}),b.find("div.description").before(d),c.editor&&b.find("div.js-url").append('<button class="js-button-accept button-save">Save</button>'),b.find(".js-button-accept").on("click",function(){a=b.find(".js-upload-url").val(),b.find("div.description").hide(),b.find(".js-fileupload").removeClass("right"),b.find(".js-url").remove(),""===a?(b.trigger("uploadsuccess","http://"),f.initWithDropzone()):f.complete(a)}),c.fileStorage!==!1&&b.append('<a class="image-upload" title="Add image"><span class="hidden">Upload</span></a>'),b.find("a.image-upload").on("click",function(){b.find(".js-url").remove(),b.find(".js-fileupload").removeClass("right"),f.initWithDropzone()})},initWithImage:function(){var a=this;b.removeClass("image-uploader image-uploader-url").addClass("pre-image-uploader"),b.find("div.description").hide(),b.append(e),b.find(".js-cancel").on("click",function(){b.find("img.js-upload-target").attr({src:""}),b.find("div.description").show(),b.delay(2500).animate({opacity:100},1e3,function(){a.init()}),b.trigger("uploadsuccess","http://"),a.initWithDropzone()})},init:function(){b.find("img.js-upload-target")[0]||b.prepend('<img class="js-upload-target" style="display: none"  src="" />'),a(".js-button-accept").prop("disabled",!1),""===b.find("img.js-upload-target").attr("src")?this.initWithDropzone():this.initWithImage()}})},a.fn.upload=function(c){var d=a.extend({progressbar:!0,editor:!1,fileStorage:!0},c);return this.each(function(){var c,e=a(this);c=new b(e,d),c.init()})}}(jQuery);var Ghost=Ghost||{};!function(){var a=function(){return[{type:"lang",filter:function(a){var b=/^(?:\{<(.*?)>\})?!(?:\[([^\n\]]*)\])(?:\(([^\n\]]*)\))?$/gim,c=/^(?!mailto:)(?:(?:https?|ftp):\/\/)?(?:\S+(?::\S*)?@)?(?:(?:(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[0-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))|localhost)(?::\d{2,5})?(?:\/[^\s]*)?$/i,d=/^(\/)?([^\/\0]+(\/)?)+$/i;return a.replace(b,function(a,b,e,f){var g,h="";return f&&(f.match(c)||f.match(d))&&(h='<img class="js-upload-target" src="'+f+'"/>'),g=Ghost&&Ghost.touchEditor?'<section class="image-uploader">'+h+'<div class="description">Mobile uploads coming soon</div></section>':'<section id="image_upload_'+b+'" class="js-drop-zone image-uploader">'+h+'<div class="description">Add image of <strong>'+e+'</strong></div><input data-url="upload" class="js-fileupload main fileupload" type="file" name="uploadimage"></section>'})}}]};"undefined"!=typeof window&&window.Showdown&&window.Showdown.extensions&&(window.Showdown.extensions.ghostimagepreview=a),"undefined"!=typeof module&&(module.exports=a)}(),function(){var a=function(){return[{type:"lang",regex:"(~T){2}([^~]+)(~T){2}",replace:function(a,b,c){return"<del>"+c+"</del>"}},{type:"lang",filter:function(a){function b(){return e++}var c={},d=/^(?:\{(.*?)\})?!(?:\[([^\n\]]*)\])(?:\(([^\n\]]*)\))?$/gim,e=0;return a=a.replace(/<pre>[\s\S]*?<\/pre>/gim,function(a){var d=b();return c[d]=a,"{gfm-js-extract-pre-"+d+"}"},"m"),a=a.replace(/```[\s\S]*```/gim,function(a){var d=b();return c[d]=a,"{gfm-js-extract-code-"+d+"}"},"m"),a=a.replace(/(^(?! {4}|\t)(?!__)\w+_\w+_\w[\w_]*)/gm,function(a){return a.replace(/_/gm,"\\_")}),a=a.replace(/\{gfm-js-extract-code-([0-9]+)\}/gm,function(a,b){return c[b]}),a=a.replace(/^[\w\<\"\'][^\n]*\n+/gm,function(a){return a.match(/\n{2}/)?a:a.trim()+"  \n"}),a=a.replace(d,function(a,b,c,d){return d?'<img src="'+d+'" alt="'+c+'" />':""}),a=a.replace(/\{gfm-js-extract-pre-([0-9]+)\}/gm,function(a,b){return"\n\n"+c[b]})}},{type:"lang",filter:function(a){return a.replace(/([^_\n\r])(_{4,})/g,function(a,b,c){return b+c.replace(/_/g,"&#95;")})}},{type:"html",filter:function(a){function b(){return e++}var c={},d={},e=0;return a=a.replace(/<(pre|code)>[\s\S]*?<\/(\1)>/gim,function(a){var c=b();return d[c]=a,"{gfm-js-extract-pre-"+c+"}"},"m"),a=a.replace(/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/gim,function(a){var d=b();return c[d]=a,"{gfm-js-extract-ref-url-"+d+"}"}),a=a.replace(/(\]\(|\]|\[|<a[^\>]*?\>)?https?\:\/\/[^"\s\<\>]*[^.,;'">\:\s\<\>\)\]\!]/gim,function(b,c,d){var e=a.slice(0,d),f=a.slice(d);return e.match(/<[^>]+$/)&&f.match(/^[^>]*>/)||c?b:c?b:"<a href='"+b+"'>"+b+"</a>"}),a=a.replace(/\{gfm-js-extract-pre-([0-9]+)\}/gm,function(a,b){return d[b]}),a=a.replace(/\{gfm-js-extract-ref-url-([0-9]+)\}/gi,function(a,b){return"\n\n"+c[b]})}}]};"undefined"!=typeof window&&window.Showdown&&window.Showdown.extensions&&(window.Showdown.extensions.ghostgfm=a),"undefined"!=typeof module&&(module.exports=a)}(),shortcut={all_shortcuts:{},add:function(a,b,c){var d={type:"keydown",propagate:!1,disable_in_input:!1,target:document,keycode:!1};if(c)for(var e in d)"undefined"==typeof c[e]&&(c[e]=d[e]);else c=d;var f=c.target;"string"==typeof c.target&&(f=document.getElementById(c.target));a=a.toLowerCase();var g=function(d){if(d=d||window.event,c.disable_in_input){var e;if(d.target?e=d.target:d.srcElement&&(e=d.srcElement),3==e.nodeType&&(e=e.parentNode),"INPUT"==e.tagName||"TEXTAREA"==e.tagName)return}if(d.keyCode)code=d.keyCode;else{if(!d.which)return;code=d.which}var f=String.fromCharCode(code).toLowerCase();188==code&&(f=","),190==code&&(f=".");var g=a.split("+"),h=0,i={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},j={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},l={shift:{wanted:!1,pressed:!1},ctrl:{wanted:!1,pressed:!1},alt:{wanted:!1,pressed:!1},meta:{wanted:!1,pressed:!1}};d.ctrlKey&&(l.ctrl.pressed=!0),d.shiftKey&&(l.shift.pressed=!0),d.altKey&&(l.alt.pressed=!0),d.metaKey&&(l.meta.pressed=!0);for(var m=0;k=g[m],m<g.length;m++)"ctrl"==k||"control"==k?(h++,l.ctrl.wanted=!0):"shift"==k?(h++,l.shift.wanted=!0):"alt"==k?(h++,l.alt.wanted=!0):"meta"==k?(h++,l.meta.wanted=!0):k.length>1?j[k]==code&&h++:c.keycode?c.keycode==code&&h++:f==k?h++:i[f]&&d.shiftKey&&(f=i[f],f==k&&h++);return h!=g.length||l.ctrl.pressed!=l.ctrl.wanted||l.shift.pressed!=l.shift.wanted||l.alt.pressed!=l.alt.wanted||l.meta.pressed!=l.meta.wanted||(b(d),c.propagate)?void 0:(d.cancelBubble=!0,d.returnValue=!1,d.stopPropagation&&(d.stopPropagation(),d.preventDefault()),!1)};this.all_shortcuts[a]={callback:g,target:f,event:c.type},f.addEventListener?f.addEventListener(c.type,g,!1):f.attachEvent?f.attachEvent("on"+c.type,g):f["on"+c.type]=g},remove:function(a){a=a.toLowerCase();var b=this.all_shortcuts[a];if(delete this.all_shortcuts[a],b){var c=b.event,d=b.target,e=b.callback;d.detachEvent?d.detachEvent("on"+c,e):d.removeEventListener?d.removeEventListener(c,e,!1):d["on"+c]=!1}}},String.prototype.toTitleCase=function(){var a=/^(a|an|and|as|at|but|by|en|for|if|in|of|on|or|the|to|vs?\.?|via)$/i;return this.replace(/([^\W_]+[^\s-]*) */g,function(b,c,d,e){return d>0&&d+c.length!==e.length&&c.search(a)>-1&&":"!==e.charAt(d-2)&&e.charAt(d-1).search(/[^\s-]/)<0?b.toLowerCase():c.substr(1).search(/[A-Z]|\../)>-1?b:b.charAt(0).toUpperCase()+b.substr(1)})},function(){"use strict";function a(){var a=window.location.pathname,b=a.substr(0,a.search("/ghost/"));return{subdir:b,apiRoot:b+"/ghost/api/v0.1"}}var b={Layout:{},Views:{},Collections:{},Models:{},paths:a(),temporary:{},currentView:null,router:null};_.extend(b,Backbone.Events),Backbone.oldsync=Backbone.sync,Backbone.sync=function(a,b,c,d){return c.beforeSend=function(a){a.setRequestHeader("X-CSRF-Token",$("meta[name='csrf-param']").attr("content"))},Backbone.oldsync(a,b,c,d)},Backbone.oldModelProtoUrl=Backbone.Model.prototype.url,Backbone.Model.prototype.url=function(){var a=Backbone.oldModelProtoUrl.apply(this,arguments);return a+("/"===a.charAt(a.length-1)?"":"/")},b.init=function(){b.router=new b.Router,b.notifications=new b.Views.NotificationCollection({model:[]}),Backbone.history.start({pushState:!0,hashChange:!1,root:b.paths.subdir+"/ghost"})},validator.handleErrors=function(a){b.notifications.clearEverything(),_.each(a,function(a){b.notifications.addItem({type:"error",message:a.message||a,status:"passive"}),a.hasOwnProperty("el")&&a.el.addClass("input-error")})},window.Ghost=b,window.addEventListener("load",b.init,!1)}(),function(){"use strict";function a(a,b,c){window.matchMedia(b).matches&&(a.preventDefault(),a.stopPropagation(),c())}FastClick.attach(document.body),$(".manage").on("click",".content-list ol li",function(b){a(b,"(max-width: 800px)",function(){$(".content-list").animate({right:"100%",left:"-100%","margin-right":"15px"},300),$(".content-preview").animate({right:"0",left:"0","margin-left":"0"},300)})}),$(".manage").on("click",".content-preview .button-back",function(b){a(b,"(max-width: 800px)",function(){$(".content-list").animate({right:"0",left:"0","margin-right":"0"},300),$(".content-preview").animate({right:"-100%",left:"100%","margin-left":"15px"},300)})}),$(".settings").on("click",".settings-menu li",function(b){a(b,"(max-width: 800px)",function(){$(".settings-sidebar").animate({right:"100%",left:"-102%","margin-right":"15px"},300),$(".settings-content").animate({right:"0",left:"0","margin-left":"0"},300),$(".settings-content .button-back, .settings-content .button-save").css("display","inline-block")})}),$(".settings").on("click",".settings-content .button-back",function(b){a(b,"(max-width: 800px)",function(){$(".settings-sidebar").animate({right:"0",left:"0","margin-right":"0"},300),$(".settings-content").animate({right:"-100%",left:"100%","margin-left":"15"},300),$(".settings-content .button-back, .settings-content .button-save").css("display","none")})}),$("[data-off-canvas]").on("click",function(b){a(b,"(max-width: 650px)",function(){$("body").toggleClass("off-canvas")})})}(),function(){"use strict";Ghost.temporary.hideToggles=function(){$("[data-toggle]").each(function(){var a=$(this).data("toggle");$(this).parent().children(a+":visible").fadeOut(150)}),$("[data-toggle].active").removeClass("active")},Ghost.temporary.initToggles=function(a){a.find("[data-toggle]").each(function(){var a=$(this).data("toggle");$(this).parent().children(a).hide()}),a.find("[data-toggle]").on("click",function(a){a.preventDefault(),a.stopPropagation();var b=$(this),c=b.data("toggle"),d=b.is(".active");Ghost.temporary.hideToggles(),d||(b.toggleClass("active"),$(this).parent().children(c).toggleClass("open").fadeToggle(150))})},$(document).ready(function(){Ghost.temporary.initToggles($(document))})}(),function(){"use strict";var a={init:function(a,b){var c=this;c.elem=b,c.style="string"==typeof a?a:a.style,c.options=$.extend({},CodeMirror.prototype.addMarkdown.options,a),c.replace()},replace:function(){var a,b,c,d,e,f,g=this.elem.getSelection(),h=!0,i=this.elem.getCursor(),j=this.elem.getLine(i.line);switch(this.style){case"h1":this.elem.setLine(i.line,"# "+j),this.elem.setCursor(i.line,i.ch+2),h=!1;break;case"h2":this.elem.setLine(i.line,"## "+j),this.elem.setCursor(i.line,i.ch+3),h=!1;break;case"h3":this.elem.setLine(i.line,"### "+j),this.elem.setCursor(i.line,i.ch+4),h=!1;break;case"h4":this.elem.setLine(i.line,"#### "+j),this.elem.setCursor(i.line,i.ch+5),h=!1;break;case"h5":this.elem.setLine(i.line,"##### "+j),this.elem.setCursor(i.line,i.ch+6),h=!1;break;case"h6":this.elem.setLine(i.line,"###### "+j),this.elem.setCursor(i.line,i.ch+7),h=!1;break;case"link":a=this.options.syntax.link.replace("$1",g),this.elem.replaceSelection(a,"end"),g?(e=j.indexOf(g,i.ch-g.length),f=e+a.length-1,this.elem.setSelection({line:i.line,ch:f-7},{line:i.line,ch:f})):this.elem.setCursor(i.line,i.ch+1),h=!1;break;case"image":a=this.options.syntax.image.replace("$1",g),""!==j&&(a="\n\n"+a),this.elem.replaceSelection(a,"end"),i=this.elem.getCursor(),this.elem.setSelection({line:i.line,ch:i.ch-8},{line:i.line,ch:i.ch-1}),h=!1;break;case"uppercase":a=g.toLocaleUpperCase();break;case"lowercase":a=g.toLocaleLowerCase();break;case"titlecase":a=g.toTitleCase();break;case"selectword":b=this.elem.getTokenAt(i),/\w$/g.test(b.string)?this.elem.setSelection({line:i.line,ch:b.start},{line:i.line,ch:b.end}):this.elem.setSelection({line:i.line,ch:b.start},{line:i.line,ch:b.end-1});break;case"copyHTML":d=new Showdown.converter,a=d.makeHtml(g?g:this.elem.getValue()),$(".modal-copyToHTML-content").text(a).selectText(),h=!1;break;case"list":a=g.replace(/^(\s*)(\w\W*)/gm,"$1* $2"),this.elem.replaceSelection(a,"end"),h=!1;break;case"currentDate":a=moment(new Date).format("D MMMM YYYY"),this.elem.replaceSelection(a,"end"),h=!1;break;case"newLine":""!==j&&this.elem.setLine(i.line,j+"\n\n"),h=!1;break;default:this.options.syntax[this.style]&&(a=this.options.syntax[this.style].replace("$1",g))}h&&a&&(this.elem.replaceSelection(a,"end"),g||(c=a.length,this.elem.setCursor({line:i.line,ch:i.ch-c/2})))}};CodeMirror.prototype.addMarkdown=function(b){var c=Object.create(a);c.init(b,this)},CodeMirror.prototype.addMarkdown.options={style:null,syntax:{bold:"**$1**",italic:"*$1*",strike:"~~$1~~",code:"`$1`",link:"[$1](http://)",image:"![$1](http://)",blockquote:"> $1"}}}(),function(){"use strict";Handlebars.registerHelper("date",function(a,b){!b&&a.hasOwnProperty("hash")&&(b=a,a=void 0,this.published_at&&(a=this.published_at)),a=null===a?void 0:a;var c,d=b.hash.format||"MMM Do, YYYY",e=b.hash.timeago;return c=e?moment(a).fromNow():moment(a).format(d)}),Handlebars.registerHelper("admin_url",function(){return Ghost.paths.subdir+"/ghost"}),Handlebars.registerHelper("asset",function(a,b){var c="",d=b&&b.hash&&b.hash.ghost;return c+=Ghost.paths.subdir+"/",a.match(/^shared/)||(c+=d?"ghost/":"assets/"),c+=a,new Handlebars.SafeString(c)})}(),function(){"use strict";var a=function(){var a,b,c,d=this,e=$(document),f=new Ghost.Editor.MarkdownEditor,g=new Ghost.Editor.UploadManager(f),h=new Ghost.Editor.HTMLPreview(f,g),i=new Ghost.Editor.ScrollHandler(f,h);a=function(){return"==============================\n\nHey there! It looks like you're in the middle of writing something and you haven't saved all of your content.\n\nSave before you go!\n\n=============================="},b=function(){d.setDirty(!0),h.update()},c=function(a){a.preventDefault()},_.extend(this,{enable:function(){e.on("markdownEditorChange",b),f.enable(),i.enable()},disable:function(){e.off("markdownEditorChange",b),f.disable(),i.disable()},value:function(){return g.value()},setDirty:function(b){window.onbeforeunload=b?a:null}}),e.on("drop dragover",c),h.update(),this.enable()};Ghost.Editor=Ghost.Editor||{},Ghost.Editor.Main=a}(),function(){"use strict";var a,b=/^(?:\{<(.*?)>\})?!(?:\[([^\n\]]*)\])(?:\(([^\n\]]*)\))?$/gim,c=/\{<([\w\W]*?)>\}/;a=function(a){var d,e,f,g,h,i,j,k={},l="image_upload",m=1;f=function(a){return a=a.replace("image_upload_",""),new RegExp("\\{<"+a+">\\}","gmi")},d=function(b,c){var d,e="{<"+m+">}",f=e+b.text;a.replaceRange(f,{line:c,ch:0},{line:c,ch:f.length}),d=a.markText({line:c,ch:0},{line:c,ch:e.length},{collapsed:!0}),k[l+"_"+m]=d,m+=1},e=function(a,b,c){delete k[a],b.clear(),c?g(c):h(a)},g=function(b){var d=b.text.match(c),e=a.getLineNumber(b);d&&a.replaceRange("",{line:e,ch:d.index},{line:e,ch:d.index+d[0].length})},h=function(b){a.eachLine(function(c){var d,e=f(b).exec(c.text);e&&(d=a.getLineNumber(c),a.replaceRange("",{line:d,ch:e.index},{line:d,ch:e.index+e[0].length}))})},i=function(){_.each(k,function(c,d){var f;c=k[d],c.find()?(f=a.getLineHandle(c.find().from.line),f.text.match(b)||e(d,c,f)):e(d,c)})},j=function(e){var f=e.text.match(b),g=e.text.match(c);f&&!g&&d(e,a.getLineNumber(e))},a.eachLine(j),_.extend(this,{markers:k,checkMarkers:i,addMarker:d,stripMarkerFromLine:g,getMarkerRegexForId:f})},Ghost.Editor=Ghost.Editor||{},Ghost.Editor.MarkerManager=a}(),function(){"use strict";var a,b=/^(?:\{<(.*?)>\})?!(?:\[([^\n\]]*)\])(?:\(([^\n\]]*)\))?$/gim,c=/\{<([\w\W]*?)>\}/;a=function(a){var d,e,f,g,h,i=a.codemirror,j=new Ghost.Editor.MarkerManager(i);d=function(a){return j.markers.hasOwnProperty(a)&&j.markers[a].find()?i.getLineHandle(j.markers[a].find().from.line):!1},e=function(a,d){var e,f=i.getLineHandle(a),g=f.text.match(b);g&&(e=f.text.match(c),!e||"paste"!==d&&"undo"!==d||j.stripMarkerFromLine(f),e||j.addMarker(f,a))},f=function(){var a=i.getValue();return _.each(j.markers,function(b,c){a=a.replace(j.getMarkerRegexForId(c),"")}),a},g=function(a,b){var c=d($(a.currentTarget).attr("id")),e=i.getLineNumber(c),f=c.text.match(/\([^\n]*\)?/),g="(http://)";f?i.setSelection({line:e,ch:f.index+1},{line:e,ch:f.index+f[0].length-1}):(f=c.text.match(/\]/),f&&(i.replaceRange(g,{line:e,ch:f.index+1},{line:e,ch:f.index+1}),i.setSelection({line:e,ch:f.index+2},{line:e,ch:f.index+g.length}))),i.replaceSelection(b)},h=function(a,b){var c=_.range(b.from.line,b.from.line+b.text.length);_.each(c,function(a){e(a,b.origin)}),j.checkMarkers()},_.extend(this,{value:f,enable:function(){var b=$("#entry-markdown-content").data("filestorage");$(".js-drop-zone").upload({editor:!0,fileStorage:b}),$(".js-drop-zone").on("uploadstart",a.off),$(".js-drop-zone").on("uploadfailure",a.on),$(".js-drop-zone").on("uploadsuccess",a.on),$(".js-drop-zone").on("uploadsuccess",g)},disable:function(){$(".js-drop-zone").off("uploadsuccess",g)}}),i.on("change",h)},Ghost.Editor=Ghost.Editor||{},Ghost.Editor.UploadManager=a}(),function(){"use strict";var a,b;a=[{key:"Ctrl+Alt+U",style:"strike"},{key:"Ctrl+Shift+K",style:"code"},{key:"Meta+K",style:"code"},{key:"Ctrl+Alt+1",style:"h1"},{key:"Ctrl+Alt+2",style:"h2"},{key:"Ctrl+Alt+3",style:"h3"},{key:"Ctrl+Alt+4",style:"h4"},{key:"Ctrl+Alt+5",style:"h5"},{key:"Ctrl+Alt+6",style:"h6"},{key:"Ctrl+Shift+L",style:"link"},{key:"Ctrl+Shift+I",style:"image"},{key:"Ctrl+Q",style:"blockquote"},{key:"Ctrl+Shift+1",style:"currentDate"},{key:"Ctrl+U",style:"uppercase"},{key:"Ctrl+Shift+U",style:"lowercase"},{key:"Ctrl+Alt+Shift+U",style:"titlecase"},{key:"Ctrl+Alt+W",style:"selectword"},{key:"Ctrl+L",style:"list"}],-1!==navigator.userAgent.indexOf("Mac")?(a.push({key:"Meta+B",style:"bold"}),a.push({key:"Meta+I",style:"italic"}),a.push({key:"Meta+Alt+C",style:"copyHTML"}),a.push({key:"Meta+Enter",style:"newLine"})):(a.push({key:"Ctrl+B",style:"bold"}),a.push({key:"Ctrl+I",style:"italic"}),a.push({key:"Ctrl+Alt+C",style:"copyHTML"}),a.push({key:"Ctrl+Enter",style:"newLine"})),b=function(){var b=CodeMirror.fromTextArea(document.getElementById("entry-markdown"),{mode:"gfm",tabMode:"indent",tabindex:"2",cursorScrollMargin:10,lineWrapping:!0,dragDrop:!1,extraKeys:{Home:"goLineLeft",End:"goLineRight"}});_.each(a,function(a){shortcut.add(a.key,function(){return b.addMarkdown({style:a.style})})}),_.extend(this,{codemirror:b,scrollViewPort:function(){return $(".CodeMirror-scroll")},scrollContent:function(){return $(".CodeMirror-sizer")},enable:function(){b.setOption("readOnly",!1),b.on("change",function(){$(document).trigger("markdownEditorChange")})},disable:function(){b.setOption("readOnly","nocursor"),b.off("change",function(){$(document).trigger("markdownEditorChange")})},isCursorAtEnd:function(){return b.getCursor("end").line>b.lineCount()-5},value:function(){return b.getValue()}})},Ghost.Editor=Ghost.Editor||{},Ghost.Editor.MarkdownEditor=b}(),function(){"use strict";var a=function(a,b){var c,d=new Showdown.converter({extensions:["ghostimagepreview","ghostgfm"]}),e=document.getElementsByClassName("rendered-markdown")[0];c=function(){e.innerHTML=d.makeHtml(a.value()),b.enable(),Countable.once(e,function(a){$(".entry-word-count").text($.pluralize(a.words,"word")),$(".entry-character-count").text($.pluralize(a.characters,"character")),$(".entry-paragraph-count").text($.pluralize(a.paragraphs,"paragraph"))})},_.extend(this,{scrollViewPort:function(){return $(".entry-preview-content")},scrollContent:function(){return $(".rendered-markdown")},update:c})};Ghost.Editor=Ghost.Editor||{},Ghost.Editor.HTMLPreview=a}(),function(){"use strict";var a=function(a,b){var c,d=a.scrollViewPort(),e=b.scrollViewPort(),f=a.scrollContent(),g=b.scrollContent();c=_.throttle(function(){var b=f.height()-d.height(),c=g.height()-e.height(),h=c/b,i=d.scrollTop()*h;a.isCursorAtEnd()&&(i=c+30),e.scrollTop(i)},10),_.extend(this,{enable:function(){d.on("scroll",c),d.scrollClass({target:".entry-markdown",offset:10}),e.scrollClass({target:".entry-preview",offset:10})},disable:function(){d.off("scroll",c)}})};Ghost.Editor=Ghost.Editor||{},Ghost.Editor.ScrollHandler=a}(),function(){Ghost.touchEditor=!1;var a,b,c,d,e,f=function(){};if(a=function(){return!window._phantom&&("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)},b=function(){return window.matchMedia("(max-width: 1000px)").matches?!0:!1},a()){$("body").addClass("touch-editor"),Ghost.touchEditor=!0,c=function(a){this.textarea=a,this.win={document:this.textarea},this.ready=!0,this.wrapping=document.createElement("div");var c=this.textarea.parentNode;this.wrapping.appendChild(this.textarea),c.appendChild(this.wrapping),this.textarea.style.opacity=1,$(this.textarea).blur(_.throttle(function(){$(document).trigger("markdownEditorChange",{panelId:a.id})},200)),b()||$(this.textarea).on("change",_.throttle(function(){$(document).trigger("markdownEditorChange",{panelId:a.id})},200))},c.prototype={setOption:function(a,b){"onChange"===a&&$(this.textarea).change(b)},eachLine:function(){return[]},getValue:function(){return this.textarea.value},setValue:function(a){this.textarea.value=a},focus:f,getCursor:function(){return{line:0,ch:0}},setCursor:f,currentLine:function(){return 0},cursorPosition:function(){return{character:0}},addMarkdown:f,nthLine:f,refresh:f,selectLines:f,on:f},d=CodeMirror;for(e in d)d.hasOwnProperty(e)&&(CodeMirror[e]=f);CodeMirror.fromTextArea=function(a,b){return new c(a,b)},CodeMirror.keyMap={basic:{}}}}(),this.JST=this.JST||{},this.JST.forgotten=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<form id="forgotten" class="forgotten-form" method="post" novalidate="novalidate">\n    <div class="email-wrap">\n        <input class="email" type="email" placeholder="Email Address" name="email" autocapitalize="off" autocorrect="off">\n    </div>\n    <button class="button-save" type="submit">Send new password</button>\n</form>\n'}),this.JST["list-item"]=Handlebars.template(function(a,b,c,d,e){function f(){return" featured"}function g(){return" page"}function h(a,b){var d,e="";return e+="\n            ",d=c["if"].call(a,a&&a.page,{hash:{},inverse:p.program(8,j,b),fn:p.program(6,i,b),data:b}),(d||0===d)&&(e+=d),e+="\n        "}function i(){return'\n                    <span class="page">Page</span>\n            '}function j(a,b){var d,e,f="";return f+='\n                <time datetime="',e={hash:{format:"YYYY-MM-DD hh:mm"},data:b},f+=o((d=c.date||a&&a.date,d?d.call(a,a&&a.published_at,e):n.call(a,"date",a&&a.published_at,e)))+'" class="date published">\n                    Published ',e={hash:{timeago:"True"},data:b},f+=o((d=c.date||a&&a.date,d?d.call(a,a&&a.published_at,e):n.call(a,"date",a&&a.published_at,e)))+"\n                </time>\n            "}function k(){return'\n            <span class="draft">Draft</span>\n        '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var l,m="",n=c.helperMissing,o=this.escapeExpression,p=this,q="function";return m+='<a class="permalink',l=c["if"].call(b,b&&b.featured,{hash:{},inverse:p.noop,fn:p.program(1,f,e),data:e}),(l||0===l)&&(m+=l),l=c["if"].call(b,b&&b.page,{hash:{},inverse:p.noop,fn:p.program(3,g,e),data:e}),(l||0===l)&&(m+=l),m+='" href="#" title="Edit this post">\n    <h3 class="entry-title">',(l=c.title)?l=l.call(b,{hash:{},data:e}):(l=b&&b.title,l=typeof l===q?l.call(b,{hash:{},data:e}):l),(l||0===l)&&(m+=l),m+='</h3>\n    <section class="entry-meta">\n        <span class="status">\n        ',l=c["if"].call(b,b&&b.published,{hash:{},inverse:p.program(10,k,e),fn:p.program(5,h,e),data:e}),(l||0===l)&&(m+=l),m+="\n        </span>\n    </section>\n</a>\n"}),this.JST.login=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+='<form id="login" class="login-form" method="post" novalidate="novalidate">\n    <div class="email-wrap">\n        <input class="email" type="email" placeholder="Email Address" name="email" autocapitalize="off" autocorrect="off">\n    </div>\n    <div class="password-wrap">\n        <input class="password" type="password" placeholder="Password" name="password">\n    </div>\n    <button class="button-save" type="submit">Log in</button>\n    <section class="meta">\n        <a class="forgotten-password" href="',(f=c.admin_url)?f=f.call(b,{hash:{},data:e}):(f=b&&b.admin_url,f=typeof f===h?f.call(b,{hash:{},data:e}):f),g+=i(f)+'/forgotten/">Forgotten password?</a>\n    </section>\n</form>\n'}),this.JST.modal=Handlebars.template(function(a,b,c,d,e){function f(a){var b,c="";return c+="-"+t((b=a&&a.options,b=null==b||b===!1?b:b.type,typeof b===s?b.apply(a):b))}function g(a,b){var d,e;return e=c.each.call(a,(d=a&&a.options,null==d||d===!1?d:d.style),{hash:{},inverse:u.noop,fn:u.program(4,h,b),data:b}),e||0===e?e:""}function h(a){var b="";return b+="modal-style-"+t(typeof a===s?a.apply(a):a)+" "}function i(a){var b,c="";
return c+='<header class="modal-header"><h1>'+t((b=a&&a.content,b=null==b||b===!1?b:b.title,typeof b===s?b.apply(a):b))+"</h1></header>"}function j(){return'<a class="close" href="#" title="Close"><span class="hidden">Close</span></a>'}function k(a,b){var d,e,f="";return f+='\n        <footer class="modal-footer">\n            <button class="js-button-accept ',e=c["if"].call(a,(d=a&&a.options,d=null==d||d===!1?d:d.confirm,d=null==d||d===!1?d:d.accept,null==d||d===!1?d:d.buttonClass),{hash:{},inverse:u.program(13,m,b),fn:u.program(11,l,b),data:b}),(e||0===e)&&(f+=e),f+='">'+t((d=a&&a.options,d=null==d||d===!1?d:d.confirm,d=null==d||d===!1?d:d.accept,d=null==d||d===!1?d:d.text,typeof d===s?d.apply(a):d))+'</button>\n            <button class="js-button-reject ',e=c["if"].call(a,(d=a&&a.options,d=null==d||d===!1?d:d.confirm,d=null==d||d===!1?d:d.reject,null==d||d===!1?d:d.buttonClass),{hash:{},inverse:u.program(17,o,b),fn:u.program(15,n,b),data:b}),(e||0===e)&&(f+=e),f+='">'+t((d=a&&a.options,d=null==d||d===!1?d:d.confirm,d=null==d||d===!1?d:d.reject,d=null==d||d===!1?d:d.text,typeof d===s?d.apply(a):d))+"</button>\n        </footer>\n        "}function l(a){var b;return t((b=a&&a.options,b=null==b||b===!1?b:b.confirm,b=null==b||b===!1?b:b.accept,b=null==b||b===!1?b:b.buttonClass,typeof b===s?b.apply(a):b))}function m(){return"button-add"}function n(a){var b;return t((b=a&&a.options,b=null==b||b===!1?b:b.confirm,b=null==b||b===!1?b:b.reject,b=null==b||b===!1?b:b.buttonClass,typeof b===s?b.apply(a):b))}function o(){return"button-delete"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var p,q,r="",s="function",t=this.escapeExpression,u=this;return r+='<article class="modal',q=c["if"].call(b,(p=b&&b.options,null==p||p===!1?p:p.type),{hash:{},inverse:u.noop,fn:u.program(1,f,e),data:e}),(q||0===q)&&(r+=q),r+=" ",q=c["if"].call(b,(p=b&&b.options,null==p||p===!1?p:p.style),{hash:{},inverse:u.noop,fn:u.program(3,g,e),data:e}),(q||0===q)&&(r+=q),r+=t((p=b&&b.options,p=null==p||p===!1?p:p.animation,typeof p===s?p.apply(b):p))+' js-modal">\n    <section class="modal-content">\n        ',q=c["if"].call(b,(p=b&&b.content,null==p||p===!1?p:p.title),{hash:{},inverse:u.noop,fn:u.program(6,i,e),data:e}),(q||0===q)&&(r+=q),r+="\n        ",q=c["if"].call(b,(p=b&&b.options,null==p||p===!1?p:p.close),{hash:{},inverse:u.noop,fn:u.program(8,j,e),data:e}),(q||0===q)&&(r+=q),r+='\n        <section class="modal-body">\n        </section>\n        ',q=c["if"].call(b,(p=b&&b.options,null==p||p===!1?p:p.confirm),{hash:{},inverse:u.noop,fn:u.program(10,k,e),data:e}),(q||0===q)&&(r+=q),r+="\n    </section>\n</article>"}),this.JST["modals/blank"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="function";return f=b&&b.content,f=null==f||f===!1?f:f.text,g=typeof f===h?f.apply(b):f,g||0===g?g:""}),this.JST["modals/copyToHTML"]=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'Press Ctrl / Cmd + C to copy the following HTML.\n<pre>\n<code class="modal-copyToHTML-content"></code>\n</pre>'}),this.JST["modals/markdown"]=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<section class="markdown-help-container">\n    <table class="modal-markdown-help-table">\n        <thead>\n        <tr>\n            <th>Result</th>\n            <th>Markdown</th>\n            <th>Shortcut</th>\n        </tr>\n        </thead>\n        <tbody>\n        <tr>\n            <td><strong>Bold</strong></td>\n            <td>**text**</td>\n            <td>Ctrl / Cmd + B</td>\n        </tr>\n        <tr>\n            <td><em>Emphasize</em></td>\n            <td>*text*</td>\n            <td>Ctrl / Cmd + I</td>\n        </tr>\n        <tr>\n            <td>Strike-through</td>\n            <td>~~text~~</td>\n            <td>Ctrl + Alt + U</td>\n        </tr>\n        <tr>\n            <td><a href="#">Link</a></td>\n            <td>[title](http://)</td>\n            <td>Ctrl + Shift + L</td>\n        </tr>\n        <tr>\n            <td>Image</td>\n            <td>![alt](http://)</td>\n            <td>Ctrl + Shift + I</td>\n        </tr>\n        <tr>\n            <td>List</td>\n            <td>* item</td>\n            <td>Ctrl + L</td>\n        </tr>\n        <tr>\n            <td>Blockquote</td>\n            <td>> quote</td>\n            <td>Ctrl + Q</td>\n        </tr>\n        <tr>\n            <td>H1</td>\n            <td># Heading</td>\n            <td>Ctrl + Alt + 1</td>\n        </tr>\n        <tr>\n            <td>H2</td>\n            <td>## Heading</td>\n            <td>Ctrl + Alt + 2</td>\n        </tr>\n        <tr>\n            <td>H3</td>\n            <td>### Heading</td>\n            <td>Ctrl + Alt + 3</td>\n        </tr>\n        <tr>\n            <td><code>Inline Code</code></td>\n            <td>`code`</td>\n            <td>Cmd + K / Ctrl + Shift + K</td>\n        </tr>\n        </tbody>\n    </table>\n    For further Markdown syntax reference: <a href="http://daringfireball.net/projects/markdown/syntax" target="_blank">Markdown Documentation</a>\n</section>'}),this.JST["modals/uploadImage"]=Handlebars.template(function(a,b,c,d,e){function f(){return' style="display: none"'}function g(a){var b,c="";return c+='accept="'+l((b=a&&a.options,b=null==b||b===!1?b:b.acceptEncoding,typeof b===k?b.apply(a):b))+'"'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j="",k="function",l=this.escapeExpression,m=this;return j+='<section class="js-drop-zone">\n    <img class="js-upload-target" src="'+l((h=b&&b.options,h=null==h||h===!1?h:h.src,typeof h===k?h.apply(b):h))+'"',i=c.unless.call(b,(h=b&&b.options,null==h||h===!1?h:h.src),{hash:{},inverse:m.noop,fn:m.program(1,f,e),data:e}),(i||0===i)&&(j+=i),j+=' alt="logo">\n    <input data-url="upload" class="js-fileupload main" type="file" name="uploadimage" ',i=c["if"].call(b,(h=b&&b.options,null==h||h===!1?h:h.acceptEncoding),{hash:{},inverse:m.noop,fn:m.program(3,g,e),data:e}),(i||0===i)&&(j+=i),j+=">\n</section>\n"}),this.JST.notification=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+="-",(d=c.type)?d=d.call(a,{hash:{},data:b}):(d=a&&a.type,d=typeof d===i?d.call(a,{hash:{},data:b}):d),e+=j(d)}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h="",i="function",j=this.escapeExpression,k=this;return h+='<section class="notification',g=c["if"].call(b,b&&b.type,{hash:{},inverse:k.noop,fn:k.program(1,f,e),data:e}),(g||0===g)&&(h+=g),h+=" notification-",(g=c.status)?g=g.call(b,{hash:{},data:e}):(g=b&&b.status,g=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(g)+' js-notification">\n    ',(g=c.message)?g=g.call(b,{hash:{},data:e}):(g=b&&b.message,g=typeof g===i?g.call(b,{hash:{},data:e}):g),(g||0===g)&&(h+=g),h+='\n    <a class="close" href="#"><span class="hidden">Close</span></a>\n</section>\n'}),this.JST.preview=Handlebars.template(function(a,b,c,d,e){function f(){return"featured"}function g(){return"unfeatured"}function h(){return"Unfeature"}function i(){return"Feature"}function j(){return"Published"}function k(){return"Written"}function l(a){var b;return s((b=a&&a.author,b=null==b||b===!1?b:b.name,typeof b===r?b.apply(a):b))}function m(a){var b;return s((b=a&&a.author,b=null==b||b===!1?b:b.email,typeof b===r?b.apply(a):b))}function n(a,b){var d,e="";return e+='\n    <div class="no-posts-box">\n        <div class="no-posts">\n            <h3>You Haven\'t Written Any Posts Yet!</h3>\n            <form action="',(d=c.admin_url)?d=d.call(a,{hash:{},data:b}):(d=a&&a.admin_url,d=typeof d===r?d.call(a,{hash:{},data:b}):d),e+=s(d)+'/editor/"><button class="button-add large" title="New Post">Write a new Post</button></form>\n        </div>\n    </div>\n'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var o,p,q="",r="function",s=this.escapeExpression,t=this;return q+='<header class="floatingheader">\n    <button class="button-back" href="#">Back</button>\n    <a class="',o=c["if"].call(b,b&&b.featured,{hash:{},inverse:t.program(3,g,e),fn:t.program(1,f,e),data:e}),(o||0===o)&&(q+=o),q+='" href="#" title="',o=c["if"].call(b,b&&b.featured,{hash:{},inverse:t.program(7,i,e),fn:t.program(5,h,e),data:e}),(o||0===o)&&(q+=o),q+=' this post">\n        <span class="hidden">Star</span>\n    </a>\n    <small>\n        <span class="status">',o=c["if"].call(b,b&&b.published,{hash:{},inverse:t.program(11,k,e),fn:t.program(9,j,e),data:e}),(o||0===o)&&(q+=o),q+='</span>\n        <span class="normal">by</span>\n        <span class="author">',p=c["if"].call(b,(o=b&&b.author,null==o||o===!1?o:o.name),{hash:{},inverse:t.program(15,m,e),fn:t.program(13,l,e),data:e}),(p||0===p)&&(q+=p),q+='</span>\n    </small>\n    <section class="post-controls">\n        <a class="post-edit" href="#" title="Edit Post"><span class="hidden">Edit Post</span></a>\n        <a class="post-settings" href="#" data-toggle=".post-settings-menu" title="Post Settings"><span class="hidden">Post Settings</span></a>\n        <div class="post-settings-menu menu-drop-right overlay">\n            <form>\n                <table class="plain">\n                    <tr class="post-setting">\n                        <td class="post-setting-label">\n                            <label for="url">URL</label>\n                        </td>\n                        <td class="post-setting-field">\n                            <input id="url" class="post-setting-slug" type="text" value="" />\n                        </td>\n                    </tr>\n                    <tr class="post-setting">\n                        <td class="post-setting-label">\n                            <label for="pub-date">Pub Date</label>\n                        </td>\n                        <td class="post-setting-field">\n                            <input id="pub-date" class="post-setting-date" type="text" value=""><!--<span class="post-setting-calendar"></span>-->\n                        </td>\n                    </tr>\n                    <tr class="post-setting">\n                        <td class="post-setting-label">\n                            <span class="label">Static Page</span>\n                        </td>\n                        <td class="post-setting-item">\n                            <input id="static-page" class="post-setting-static-page" type="checkbox" value="">\n                            <label class="checkbox" for="static-page"></label>\n                        </td>\n                    </tr>\n                </table>\n            </form>\n            <a class="delete" href="#">Delete This Post</a>\n        </div>\n    </section>\n</header>\n<section class="content-preview-content">\n    <div class="wrapper"><h1>',(p=c.title)?p=p.call(b,{hash:{},data:e}):(p=b&&b.title,p=typeof p===r?p.call(b,{hash:{},data:e}):p),(p||0===p)&&(q+=p),q+="</h1>",(p=c.html)?p=p.call(b,{hash:{},data:e}):(p=b&&b.html,p=typeof p===r?p.call(b,{hash:{},data:e}):p),(p||0===p)&&(q+=p),q+="</div>\n</section>\n",p=c.unless.call(b,b&&b.title,{hash:{},inverse:t.noop,fn:t.program(17,n,e),data:e}),(p||0===p)&&(q+=p),q+="\n"}),this.JST.reset=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<form id="reset" class="reset-form" method="post" novalidate="novalidate">\n    <div class="password-wrap">\n        <input class="password" type="password" placeholder="Password" name="newpassword" />\n    </div>\n    <div class="password-wrap">\n        <input class="password" type="password" placeholder="Confirm Password" name="ne2password" />\n    </div>\n    <button class="button-save" type="submit">Reset Password</button>\n</form>\n'}),this.JST["settings/apps"]=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+="\n        <li>\n            ",d=c["if"].call(a,a&&a["package"],{hash:{},inverse:o.program(4,h,b),fn:o.program(2,g,b),data:b}),(d||0===d)&&(e+=d),e+='\n            <button data-app="',(d=c.name)?d=d.call(a,{hash:{},data:b}):(d=a&&a.name,d=typeof d===m?d.call(a,{hash:{},data:b}):d),e+=n(d)+'" class="',d=c["if"].call(a,a&&a.active,{hash:{},inverse:o.program(8,j,b),fn:o.program(6,i,b),data:b}),(d||0===d)&&(e+=d),e+="</button>\n        </li>\n        "}function g(a){var b,c="";return c+=n((b=a&&a["package"],b=null==b||b===!1?b:b.name,typeof b===m?b.apply(a):b))+" - "+n((b=a&&a["package"],b=null==b||b===!1?b:b.version,typeof b===m?b.apply(a):b))}function h(a,b){var d,e="";return(d=c.name)?d=d.call(a,{hash:{},data:b}):(d=a&&a.name,d=typeof d===m?d.call(a,{hash:{},data:b}):d),e+=n(d)+" - package.json missing :("}function i(){return'button-delete js-button-deactivate js-button-active">Deactivate'}function j(){return'button-add js-button-activate">Activate'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var k,l="",m="function",n=this.escapeExpression,o=this;return l+='<header>\n    <button class="button-back">Back</button>\n    <h2 class="title">Apps</h2>\n</header>\n\n<section class="content">\n    <ul class="js-apps">\n        ',k=c.each.call(b,b&&b.availableApps,{hash:{},inverse:o.noop,fn:o.program(1,f,e),data:e}),(k||0===k)&&(l+=k),l+="\n    </ul>\n</section>"}),this.JST["settings/general"]=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+='\n                    <a class="js-modal-logo" href="#"><img id="blog-logo" src="',(d=c.logo)?d=d.call(a,{hash:{},data:b}):(d=a&&a.logo,d=typeof d===q?d.call(a,{hash:{},data:b}):d),e+=r(d)+'" alt="logo"></a>\n                '}function g(){return'\n                    <a class="button-add js-modal-logo" >Upload Image</a>\n                '}function h(a,b){var d,e="";return e+='\n                    <a class="js-modal-cover" href="#"><img id="blog-cover" src="',(d=c.cover)?d=d.call(a,{hash:{},data:b}):(d=a&&a.cover,d=typeof d===q?d.call(a,{hash:{},data:b}):d),e+=r(d)+'" alt="cover photo"></a>\n                '}function i(){return'\n                    <a class="button-add js-modal-cover">Upload Image</a>\n                '}function j(a,b){var d,e="";return e+='\n                        <option value="',(d=c.name)?d=d.call(a,{hash:{},data:b}):(d=a&&a.name,d=typeof d===q?d.call(a,{hash:{},data:b}):d),e+=r(d)+'" ',d=c["if"].call(a,a&&a.active,{hash:{},inverse:s.noop,fn:s.program(10,k,b),data:b}),(d||0===d)&&(e+=d),e+=">",d=c["if"].call(a,a&&a["package"],{hash:{},inverse:s.program(14,m,b),fn:s.program(12,l,b),data:b}),(d||0===d)&&(e+=d),e+="</option>\n                        ",d=c.unless.call(a,a&&a["package"],{hash:{},inverse:s.noop,fn:s.program(16,n,b),data:b}),(d||0===d)&&(e+=d),e+="\n                    "}function k(){return"selected"}function l(a){var b,c="";return c+=r((b=a&&a["package"],b=null==b||b===!1?b:b.name,typeof b===q?b.apply(a):b))+" - "+r((b=a&&a["package"],b=null==b||b===!1?b:b.version,typeof b===q?b.apply(a):b))}function m(a,b){var d;return(d=c.name)?d=d.call(a,{hash:{},data:b}):(d=a&&a.name,d=typeof d===q?d.call(a,{hash:{},data:b}):d),r(d)}function n(a,b){var d,e="";return e+="<script>console.log('Hi! The theme named \"",(d=c.name)?d=d.call(a,{hash:{},data:b}):(d=a&&a.name,d=typeof d===q?d.call(a,{hash:{},data:b}):d),e+=r(d)+"\" does not have a package.json file or it\\'s malformed. This will be required in the future. For more info, see http://docs.ghost.org/themes/.');</script>"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var o,p="",q="function",r=this.escapeExpression,s=this;return p+='<header>\n    <button class="button-back">Back</button>\n    <h2 class="title">General</h2>\n    <section class="page-actions">\n        <button class="button-save">Save</button>\n    </section>\n</header>\n\n<section class="content">\n    <form id="settings-general" novalidate="novalidate">\n        <fieldset>\n\n            <div class="form-group">\n                <label for="blog-title">Blog Title</label>\n                <input id="blog-title" name="general[title]" type="text" value="',(o=c.title)?o=o.call(b,{hash:{},data:e}):(o=b&&b.title,o=typeof o===q?o.call(b,{hash:{},data:e}):o),p+=r(o)+'" />\n                <p>The name of your blog</p>\n            </div>\n\n            <div class="form-group description-container">\n                <label for="blog-description">Blog Description</label>\n                <textarea id="blog-description">',(o=c.description)?o=o.call(b,{hash:{},data:e}):(o=b&&b.description,o=typeof o===q?o.call(b,{hash:{},data:e}):o),p+=r(o)+'</textarea>\n                <p>\n                    Describe what your blog is about\n                    <span class="word-count">0</span>\n                </p>\n\n            </div>\n        </fieldset>\n            <div class="form-group">\n                <label for="blog-logo">Blog Logo</label>\n                ',o=c["if"].call(b,b&&b.logo,{hash:{},inverse:s.program(3,g,e),fn:s.program(1,f,e),data:e}),(o||0===o)&&(p+=o),p+='\n                <p>Display a sexy logo for your publication</p>\n            </div>\n\n            <div class="form-group">\n                <label for="blog-cover">Blog Cover</label>\n                ',o=c["if"].call(b,b&&b.cover,{hash:{},inverse:s.program(7,i,e),fn:s.program(5,h,e),data:e}),(o||0===o)&&(p+=o),p+='\n                <p>Display a cover image on your site</p>\n            </div>\n        <fieldset>\n            <div class="form-group">\n                <label for="email-address">Email Address</label>\n                <input id="email-address" name="general[email-address]" type="email" value="',(o=c.email)?o=o.call(b,{hash:{},data:e}):(o=b&&b.email,o=typeof o===q?o.call(b,{hash:{},data:e}):o),p+=r(o)+'" autocapitalize="off" autocorrect="off" />\n                <p>Address to use for admin notifications</p>\n            </div>\n\n            <div class="form-group">\n                <label for="postsPerPage">Posts per page</label>\n                <input id="postsPerPage" name="general[postsPerPage]" type="number" value="',(o=c.postsPerPage)?o=o.call(b,{hash:{},data:e}):(o=b&&b.postsPerPage,o=typeof o===q?o.call(b,{hash:{},data:e}):o),p+=r(o)+'" />\n                <p>How many posts should be displayed on each page</p>\n            </div>\n\n            <div class="form-group">\n                <label for="permalinks">Dated Permalinks</label>\n                <input id="permalinks" name="general[permalinks]" type="checkbox" value=\'permalink\'/>\n                <label class="checkbox" for="permalinks"></label>\n                <p>Include the date in your post URLs</p>\n            </div>\n\n            <div class="form-group">\n                <label for="activeTheme">Theme</label>\n                <select id="activeTheme" name="general[activeTheme]">\n                    ',o=c.each.call(b,b&&b.availableThemes,{hash:{},inverse:s.noop,fn:s.program(9,j,e),data:e}),(o||0===o)&&(p+=o),p+="\n                </select>\n                <p>Select a theme for your blog</p>\n            </div>\n\n        </fieldset>\n    </form>\n</section>\n"}),this.JST["settings/sidebar"]=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<header>\n    <h1 class="title">Settings</h1>\n</header>\n<nav class="settings-menu">\n    <ul>\n        <li class="general"><a href="#general">General</a></li>\n        <li class="users"><a href="#user">User</a></li>\n        <li class="apps"><a href="#apps">Apps</a></li>\n    </ul>\n</nav>'}),this.JST["settings/user-profile"]=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d;return(d=c.cover)?d=d.call(a,{hash:{},data:b}):(d=a&&a.cover,d=typeof d===l?d.call(a,{hash:{},data:b}):d),m(d)}function g(a,b){var d,e;return e={hash:{},data:b},m((d=c.asset||a&&a.asset,d?d.call(a,"shared/img/user-cover.png",e):n.call(a,"asset","shared/img/user-cover.png",e)))}function h(a,b){var d;return(d=c.image)?d=d.call(a,{hash:{},data:b}):(d=a&&a.image,d=typeof d===l?d.call(a,{hash:{},data:b}):d),m(d)}function i(a,b){var d,e;return e={hash:{},data:b},m((d=c.asset||a&&a.asset,d?d.call(a,"shared/img/user-image.png",e):n.call(a,"asset","shared/img/user-image.png",e)))}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var j,k="",l="function",m=this.escapeExpression,n=c.helperMissing,o=this;return k+='<header>\n    <button class="button-back">Back</button>\n    <h2 class="title">Your Profile</h2>\n    <section class="page-actions">\n        <button class="button-save">Save</button>\n    </section>\n</header>\n\n<section class="content no-padding">\n\n    <header class="user-profile-header">\n        <img id="user-cover" class="cover-image" src="',j=c["if"].call(b,b&&b.cover,{hash:{},inverse:o.program(3,g,e),fn:o.program(1,f,e),data:e}),(j||0===j)&&(k+=j),k+='" title="',(j=c.name)?j=j.call(b,{hash:{},data:e}):(j=b&&b.name,j=typeof j===l?j.call(b,{hash:{},data:e}):j),k+=m(j)+'\'s Cover Image"/>\n\n        <a class="edit-cover-image js-modal-cover button" href="#">Change Cover</a>\n    </header>\n\n    <form class="user-profile" novalidate="novalidate">\n\n        <fieldset class="user-details-top">\n\n            <figure class="user-image">\n                <div id="user-image" class="img" style="background-image: url(',j=c["if"].call(b,b&&b.image,{hash:{},inverse:o.program(7,i,e),fn:o.program(5,h,e),data:e}),(j||0===j)&&(k+=j),k+=');" href="#"><span class="hidden">',(j=c.name)?j=j.call(b,{hash:{},data:e}):(j=b&&b.name,j=typeof j===l?j.call(b,{hash:{},data:e}):j),k+=m(j)+'\'s Picture</span></div>\n                <a href="#" class="edit-user-image js-modal-image">Edit Picture</a>\n            </figure>\n\n            <div class="form-group">\n                <label for="user-name" class="hidden">Full Name</label>\n                <input type="text" value="',(j=c.name)?j=j.call(b,{hash:{},data:e}):(j=b&&b.name,j=typeof j===l?j.call(b,{hash:{},data:e}):j),k+=m(j)+'" id="user-name" placeholder="Full Name" autocorrect="off" />\n                <p>Use your real name so people can recognise you</p>\n            </div>\n\n        </fieldset>\n\n        <fieldset class="user-details-bottom">\n\n            <div class="form-group">\n                <label for"user-email">Email</label>\n                <input type="email" value="',(j=c.email)?j=j.call(b,{hash:{},data:e}):(j=b&&b.email,j=typeof j===l?j.call(b,{hash:{},data:e}):j),k+=m(j)+'" id="user-email" placeholder="Email Address" autocapitalize="off" autocorrect="off" />\n                <p>Used for notifications</p>\n            </div>\n\n            <div class="form-group">\n                <label for="user-location">Location</label>\n                <input type="text" value="',(j=c.location)?j=j.call(b,{hash:{},data:e}):(j=b&&b.location,j=typeof j===l?j.call(b,{hash:{},data:e}):j),k+=m(j)+'" id="user-location" />\n                <p>Where in the world do you live?</p>\n            </div>\n\n            <div class="form-group">\n                <label for="user-website">Website</label>\n                <input type="url" value="',(j=c.website)?j=j.call(b,{hash:{},data:e}):(j=b&&b.website,j=typeof j===l?j.call(b,{hash:{},data:e}):j),k+=m(j)+'" id="user-website" autocapitalize="off" autocorrect="off" />\n                <p>Have a website or blog other than this one? Link it!</p>\n            </div>\n\n            <div class="form-group bio-container">\n                <label for="user-bio">Bio</label>\n                <textarea id="user-bio">',(j=c.bio)?j=j.call(b,{hash:{},data:e}):(j=b&&b.bio,j=typeof j===l?j.call(b,{hash:{},data:e}):j),k+=m(j)+'</textarea>\n                <p>\n                    Write about you, in 200 characters or less.\n                    <span class="word-count">0</span>\n                </p>\n            </div>\n\n            <hr />\n\n        </fieldset>\n\n        <fieldset>\n\n            <div class="form-group">\n                <label for="user-password-old">Old Password</label>\n                <input type="password" id="user-password-old" />\n            </div>\n\n            <div class="form-group">\n                <label for="user-password-new">New Password</label>\n                <input type="password" id="user-password-new" />\n            </div>\n\n            <div class="form-group">\n                <label for="user-new-password-verification">Verify Password</label>\n                <input type="password" id="user-new-password-verification" />\n            </div>\n            <div class="form-group">\n                <button type="button" class="button-delete button-change-password">Change Password</button>\n            </div>\n\n        </fieldset>\n\n    </form>\n</section>\n'}),this.JST.signup=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<form id="signup" class="signup-form" method="post" novalidate="novalidate">\n    <div class="name-wrap">\n        <input class="name" type="text" placeholder="Full Name" name="name" autocorrect="off" />\n    </div>\n    <div class="email-wrap">\n        <input class="email" type="email" placeholder="Email Address" name="email" autocapitalize="off" autocorrect="off" />\n    </div>\n    <div class="password-wrap">\n        <input class="password" type="password" placeholder="Password" name="password" />\n    </div>\n    <button class="button-save" type="submit">Sign Up</button>\n</form>\n'}),function(){"use strict";function a(a,b,c){if(void 0!==c&&_.isObject(c)){NProgress.start();var d=this,e=c.success;c.success=function(){return NProgress.done(),e.apply(d,arguments)}}return Backbone.sync.call(this,a,b,c)}NProgress.configure({showSpinner:!1}),Ghost.ProgressModel=Backbone.Model.extend({sync:a}),Ghost.ProgressCollection=Backbone.Collection.extend({sync:a})}(),function(){"use strict";Ghost.Models.Post=Ghost.ProgressModel.extend({defaults:{status:"draft"},blacklist:["published","draft"],parse:function(a){return a.posts&&(a=a.posts[0]),a.status&&(a.published="published"===a.status,a.draft="draft"===a.status),a.tags?a:a},validate:function(a){return _.isEmpty(a.title)?"You must specify a title for the post.":void 0},addTag:function(a){var b=this.get("tags")||[];b.push(a),this.set("tags",b)},removeTag:function(a){var b=this.get("tags")||[];b=_.reject(b,function(b){return b.id===a.id||b.name===a.name}),this.set("tags",b)},sync:function(a,b,c){return("create"===a||"update"===a)&&(c.data=JSON.stringify({posts:[this.attributes]}),c.contentType="application/json",c.url=b.url()+"?include=tags"),Backbone.Model.prototype.sync.apply(this,arguments)}}),Ghost.Collections.Posts=Backbone.Collection.extend({currentPage:1,totalPages:0,totalPosts:0,nextPage:0,prevPage:0,url:Ghost.paths.apiRoot+"/posts/",model:Ghost.Models.Post,parse:function(a){return _.isArray(a.posts)?(this.limit=a.meta.pagination.limit,this.currentPage=a.meta.pagination.page,this.totalPages=a.meta.pagination.pages,this.totalPosts=a.meta.pagination.total,this.nextPage=a.meta.pagination.next,this.prevPage=a.meta.pagination.prev,a.posts):a}})}(),function(){"use strict";Ghost.Models.Settings=Ghost.ProgressModel.extend({url:Ghost.paths.apiRoot+"/settings/?type=blog,theme,app",id:"0",parse:function(a){var b=_.reduce(a.settings,function(a,b){return a[b.key]=b.value,a},{});return b},sync:function(a,b,c){var d=_.map(this.attributes,function(a,b){return{key:b,value:a}});return"update"===a&&(c.data=JSON.stringify({settings:d}),c.contentType="application/json"),Backbone.Model.prototype.sync.apply(this,arguments)}})}(),function(){"use strict";Ghost.Collections.Tags=Ghost.ProgressCollection.extend({url:Ghost.paths.apiRoot+"/tags/",parse:function(a){return a.tags}})}(),function(){"use strict";Ghost.Models.Themes=Backbone.Model.extend({url:Ghost.paths.apiRoot+"/themes/"})}(),function(){"use strict";Ghost.Models.uploadModal=Backbone.Model.extend({options:{close:!0,type:"action",style:["wide"],animation:"fade",afterRender:function(){var a=$("#"+this.options.model.id).data("filestorage");this.$(".js-drop-zone").upload({fileStorage:a})},confirm:{reject:{func:function(){return!0},buttonClass:!0,text:"Cancel"}}},content:{template:"uploadImage"},initialize:function(a){this.options.id=a.id,this.options.key=a.key,this.options.src=a.src,this.options.confirm.accept=a.accept,this.options.acceptEncoding=a.acceptEncoding||"image/*"}})}(),function(){"use strict";Ghost.Models.User=Ghost.ProgressModel.extend({url:Ghost.paths.apiRoot+"/users/me/",parse:function(a){return a.users&&(a=a.users[0]),a},sync:function(a,b,c){return("create"===a||"update"===a)&&(c.data=JSON.stringify({users:[this.attributes]}),c.contentType="application/json"),Backbone.Model.prototype.sync.apply(this,arguments)}})}(),function(){"use strict";Ghost.Models.Widget=Ghost.ProgressModel.extend({defaults:{title:"",name:"",author:"",applicationID:"",size:"",content:{template:"",data:{number:{count:0,sub:{value:0,dir:"",item:"",period:""}}}},settings:{settingsPane:!1,enabled:!1,options:[{title:"ERROR",value:"Widget options not set"}]}}}),Ghost.Collections.Widgets=Ghost.ProgressCollection.extend({model:Ghost.Models.Widget})}(),function(){"use strict";Ghost.TemplateView=Backbone.View.extend({templateName:"widget",template:function(a){return JST[this.templateName](a)},templateData:function(){return this.model?this.model.toJSON():this.collection?this.collection.toJSON():{}},render:function(){return _.isFunction(this.beforeRender)&&this.beforeRender(),this.$el.html(this.template(this.templateData())),_.isFunction(this.afterRender)&&this.afterRender(),this}}),Ghost.View=Ghost.TemplateView.extend({addSubview:function(a){if(!(a instanceof Backbone.View))throw new Error("Subview must be a Backbone.View");return this.subviews=this.subviews||[],this.subviews.push(a),a},removeSubviews:function(){var a=this.subviews;return a?(_(a).invoke("remove"),this.subviews=[],this):this},remove:function(){return this.subviews&&this.removeSubviews(),Backbone.View.prototype.remove.apply(this,arguments)}}),Ghost.Views.Utils={getRequestErrorMessage:function(a){var b,c;if(!a)return null;if(b=a.statusText,200!==a.status)try{a.responseJSON.errors&&_.isArray(a.responseJSON.errors)?(b="",_.each(a.responseJSON.errors,function(a){b+="<br/>"+a.message})):b=a.responseJSON.error||"Unknown Error"}catch(d){c=a.status?a.status+" - "+a.statusText:"Server was not available",b="The server returned an error ("+c+")."}return b},getUrlVariables:function(){var a,b,c=[],d=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(b=0;b<d.length;b+=1)a=d[b].split("="),c.push(a[0]),c[a[0]]=a[1];return c}},Ghost.Views.Notification=Ghost.View.extend({templateName:"notification",className:"js-bb-notification",template:function(a){return JST[this.templateName](a)},render:function(){var a=this.template(this.model);return this.$el.html(a),this}}),Ghost.Views.NotificationCollection=Ghost.View.extend({el:"#notifications",initialize:function(){var a=this;this.render(),Ghost.on("urlchange",function(){a.clearEverything()}),shortcut.add("ESC",function(){$(".js-modal").length<1&&a.clearEverything()})},events:{"animationend .js-notification":"removeItem","webkitAnimationEnd .js-notification":"removeItem","oanimationend .js-notification":"removeItem","MSAnimationEnd .js-notification":"removeItem","click .js-notification.notification-passive .close":"closePassive","click .js-notification.notification-persistent .close":"closePersistent"},render:function(){_.each(this.model,function(a){this.renderItem(a)},this)},renderItem:function(a){var b,c=new Ghost.Views.Notification({model:a}),d=$(c.render().el);this.$el.append(d),b=d.hide().outerHeight(!0),d.animate({height:b},250,function(){$(this).css({height:"auto"}).fadeIn(250)})},addItem:function(a){this.model.push(a),this.renderItem(a)},clearEverything:function(){this.$el.find(".js-notification.notification-passive").parent().remove()},removeItem:function(a){a.preventDefault();var b=a.currentTarget,c=this;-1!==b.className.indexOf("notification-persistent")?$.ajax({type:"DELETE",headers:{"X-CSRF-Token":$("meta[name='csrf-param']").attr("content")},url:Ghost.paths.apiRoot+"/notifications/"+$(b).find(".close").data("id")}).done(function(){c.$el.slideUp(250,function(){$(this).show().css({height:"auto"}),$(b).remove()
})}):$(b).slideUp(250,function(){$(this).show().css({height:"auto"}).parent().remove()})},closePassive:function(a){$(a.currentTarget).parent().fadeOut(250).slideUp(250,function(){$(this).remove()})},closePersistent:function(a){var b=a.currentTarget,c=this;$.ajax({type:"DELETE",headers:{"X-CSRF-Token":$("meta[name='csrf-param']").attr("content")},url:Ghost.paths.apiRoot+"/notifications/"+$(b).data("id")}).done(function(){var a=c.$(".js-notification").outerHeight(!0),d=$(b).parent();c.$el.css({height:a}),d.parent().hasClass("js-bb-notification")?d.parent().fadeOut(200,function(){$(this).remove(),c.$el.slideUp(250,function(){$(this).show().css({height:"auto"})})}):d.fadeOut(200,function(){$(this).remove(),c.$el.slideUp(250,function(){$(this).show().css({height:"auto"})})})})}}),Ghost.Views.Modal=Ghost.View.extend({el:"#modal-container",templateName:"modal",className:"js-bb-modal",initialize:function(){this.render();var a=this;this.model.options.close?(shortcut.add("ESC",function(){a.removeElement()}),$(document).on("click",".modal-background",function(){a.removeElement()})):(shortcut.remove("ESC"),$(document).off("click",".modal-background")),this.model.options.confirm&&(this.acceptModal=function(){this.model.options.confirm.accept.func.call(this),a.removeElement()},this.rejectModal=function(){this.model.options.confirm.reject.func.call(this),a.removeElement()})},templateData:function(){return this.model},events:{"click .close":"removeElement","click .js-button-accept":"acceptModal","click .js-button-reject":"rejectModal"},afterRender:function(){this.$el.fadeIn(50),$(".modal-background").show(10,function(){$(this).addClass("in")}),this.model.options.confirm&&this.$(".close").remove(),this.$(".modal-body").html(this.addSubview(new Ghost.Views.Modal.ContentView({model:this.model})).render().el),_.isFunction(this.model.options.afterRender)&&this.model.options.afterRender.call(this),this.model.options.animation&&this.animate(this.$el.children(".js-modal"))},remove:function(){return this.undelegateEvents(),this.$el.empty(),this.stopListening(),this},removeElement:function(a){a&&(a.preventDefault(),a.stopPropagation());var b=this,c=$(".js-modal"),d=c.transitionDuration(),e=b.$el.transitionDuration();c.removeClass("in"),this.model.options.animation||(d=e=0),setTimeout(function(){void 0!==document.body.style.filter&&$("body").removeClass("blur"),$(".modal-background").removeClass("in"),setTimeout(function(){b.remove(),b.$el.hide(),$(".modal-background").hide()},e)},d)},animate:function(a){setTimeout(function(){a.addClass("in")},a.transitionDuration())}}),Ghost.Views.Modal.ContentView=Ghost.View.extend({template:function(a){return JST["modals/"+this.model.content.template](a)},templateData:function(){return this.model}})}(),function(){"use strict";var a,b,c;Ghost.Views.Blog=Ghost.View.extend({initialize:function(){var b=this,d=function(){NProgress.done()};this.listenTo(this.collection,"request",function(){NProgress.start()}),this.listenTo(this.collection,"sync",d),this.listenTo(this.collection,"destroy",function(a){b.listenToOnce(a,"sync",d)}),this.addSubview(new c({el:".js-content-preview",collection:this.collection})).render(),this.addSubview(new a({el:".js-content-list",collection:this.collection})).render()}}),a=Ghost.View.extend({isLoading:!1,events:{"click .content-list-content":"scrollHandler"},initialize:function(){this.$(".content-list-content").scrollClass({target:".content-list",offset:10}),this.listenTo(this.collection,"remove",this.showNext),this.listenTo(this.collection,"add",this.renderPost),this.$(".content-list-content").scroll($.proxy(this.checkScroll,this))},showNext:function(){if(!this.isLoading){if(!this.collection.length)return Backbone.trigger("blog:activeItem",null);var a=this.collection.at(0)?this.collection.at(0).id:!1;a&&Backbone.trigger("blog:activeItem",a)}},reportLoadError:function(a){var b="A problem was encountered while loading more posts";b+=a?"; "+Ghost.Views.Utils.getRequestErrorMessage(a):".",Ghost.notifications.addItem({type:"error",message:b,status:"passive"})},checkScroll:function(a){var b=this,c=a.target,d=100;this.isLoading||c.scrollTop+c.clientHeight+d<=c.scrollHeight||this.collection.currentPage>=this.collection.totalPages||(this.isLoading=!0,this.collection.fetch({update:!0,remove:!1,data:{status:"all",page:b.collection.currentPage+1,staticPages:"all"}}).then(function(){b.render(),b.isLoading=!1},function(a){b.reportLoadError(a)}))},renderPost:function(a){this.$("ol").append(this.addSubview(new b({model:a})).render().el)},render:function(){var a=this.$("ol");this.removeSubviews(),this.collection.each(function(c){a.append(this.addSubview(new b({model:c})).render().el)},this),this.showNext()}}),b=Ghost.View.extend({tagName:"li",events:{"click a":"setActiveItem"},active:!1,initialize:function(){this.listenTo(Backbone,"blog:activeItem",this.checkActive),this.listenTo(this.model,"change:page change:featured",this.render),this.listenTo(this.model,"destroy",this.removeItem)},removeItem:function(){var a=this;$.when(this.$el.slideUp()).then(function(){a.remove()})},setActiveItem:function(a){a.preventDefault(),this.active!==!0&&(Backbone.trigger("blog:activeItem",this.model.id),this.render())},checkActive:function(a){this.model.id!==a?this.active&&(this.active=!1,this.$el.removeClass("active"),this.render()):(this.active=!0,this.$el.addClass("active"))},showPreview:function(a){var b=$(a.currentTarget);this.$(".content-list-content li").removeClass("active"),b.addClass("active"),Backbone.trigger("blog:activeItem",b.data("id"))},templateName:"list-item",templateData:function(){return _.extend({active:this.active},this.model.toJSON())}}),c=Ghost.View.extend({activeId:null,events:{"click .post-controls .post-edit":"editPost","click .featured":"toggleFeatured","click .unfeatured":"toggleFeatured"},initialize:function(){this.listenTo(Backbone,"blog:activeItem",this.setActivePreview)},setActivePreview:function(a){this.activeId!==a&&(this.activeId=a,this.render())},editPost:function(a){a.preventDefault(),window.location=Ghost.paths.subdir+"/ghost/editor/"+this.model.get("id")+"/"},toggleFeatured:function(a){a.preventDefault();var b=this,c=!b.model.get("featured"),d=$(a.currentTarget),e=this.collection.get(this.activeId);e.save({featured:c},{success:function(){d.removeClass("featured unfeatured").addClass(c?"featured":"unfeatured"),Ghost.notifications.clearEverything(),Ghost.notifications.addItem({type:"success",message:"Post successfully marked as "+(c?"featured":"not featured")+".",status:"passive"})},error:function(a,b){Ghost.notifications.addItem({type:"error",message:Ghost.Views.Utils.getRequestErrorMessage(b),status:"passive"})}})},templateName:"preview",render:function(){return this.model=this.collection.get(this.activeId),this.$el.html(this.template(this.templateData())),this.$(".content-preview-content").scrollClass({target:".content-preview",offset:10}),this.$(".wrapper").on("click","a",function(a){$(a.currentTarget).attr("target","_blank")}),void 0!==this.model&&this.addSubview(new Ghost.View.PostSettings({el:$(".post-controls"),model:this.model})).render(),Ghost.temporary.initToggles(this.$el),this}})}(),function(){"use strict";Ghost.Views.Debug=Ghost.View.extend({events:{"click .settings-menu a":"handleMenuClick","click #startupload":"handleUploadClick","click .js-delete":"handleDeleteClick","click #sendtestmail":"handleSendTestMailClick"},initialize:function(){var a=this;this.uploadButton=this.$el.find("#startupload"),this.uploadButton.prop("disabled","disabled"),$("#importfile").fileupload({url:Ghost.paths.apiRoot+"/db/",limitMultiFileUploads:1,replaceFileInput:!1,headers:{"X-CSRF-Token":$("meta[name='csrf-param']").attr("content")},dataType:"json",add:function(b,c){a.fileUploadData=c,c.context=a.uploadButton.removeProp("disabled")},done:function(a,b){if($("#startupload").text("Import"),!b.result)throw new Error("No response received from server.");if(!b.result.message)throw new Error("Unknown error");Ghost.notifications.addItem({type:"success",message:b.result.message,status:"passive"})},error:function(a){$("#startupload").text("Import");var b=a.responseJSON,c=b&&b.errors[0].message?b.errors[0].message:"unknown";Ghost.notifications.addItem({type:"error",message:["A problem was encountered while importing new content to your blog. Error: ",c].join(""),status:"passive"})}})},handleMenuClick:function(a){a.preventDefault();var b=$(a.currentTarget);return this.$(".settings-content").hide(),this.$("#debug-"+b.attr("class")).show(),!1},handleUploadClick:function(a){a.preventDefault(),this.uploadButton.prop("disabled")||(this.fileUploadData.context=this.uploadButton.text("Importing"),this.fileUploadData.submit()),this.uploadButton.prop("disabled","disabled")},handleDeleteClick:function(a){a.preventDefault(),this.addSubview(new Ghost.Views.Modal({model:{options:{close:!0,confirm:{accept:{func:function(){$.ajax({url:Ghost.paths.apiRoot+"/db/",type:"DELETE",headers:{"X-CSRF-Token":$("meta[name='csrf-param']").attr("content")},success:function(a){if(!a)throw new Error("No response received from server.");if(!a.message)throw new Error(a.detail||"Unknown error");Ghost.notifications.addItem({type:"success",message:a.message,status:"passive"})},error:function(a){var b=JSON.parse(a.responseText),c=b&&b.errors[0].message?b.errors[0].message:"unknown";Ghost.notifications.addItem({type:"error",message:["A problem was encountered while deleting content from your blog. Error: ",c].join(""),status:"passive"})}})},text:"Delete",buttonClass:"button-delete"},reject:{func:function(){return!0},text:"Cancel",buttonClass:"button"}},type:"action",style:["wide","centered"],animation:"fade"},content:{template:"blank",title:"Would you really like to delete all content from your blog?",text:"<p>This is permanent! No backups, no restores, no magic undo button. <br /> We warned you, ok?</p>"}}}))},handleSendTestMailClick:function(a){a.preventDefault(),$.ajax({url:Ghost.paths.apiRoot+"/mail/test/",type:"POST",headers:{"X-CSRF-Token":$("meta[name='csrf-param']").attr("content")},success:function(a){Ghost.notifications.addItem({type:"success",message:["Check your email for the test message: ",a.message].join(""),status:"passive"})},error:function(a){var b=JSON.parse(a.responseText),c=b&&b.errors[0].message?b.errors[0].message:"unknown";Ghost.notifications.addItem({type:"error",message:["A problem was encountered while sending the test email: ",c].join(""),status:"passive"})}})}})}(),function(){"use strict";Ghost.View.EditorActionsWidget=Ghost.View.extend({events:{"click [data-set-status]":"handleStatus","click .js-publish-button":"handlePostButton"},statusMap:null,createStatusMap:{draft:"Save Draft",published:"Publish Now"},updateStatusMap:{draft:"Unpublish",published:"Update Post"},messageMap:{errors:{post:{published:{published:"Your post could not be updated.",draft:"Your post could not be saved as a draft."},draft:{published:"Your post could not be published.",draft:"Your post could not be saved as a draft."}}},success:{post:{published:{published:"Your post has been updated.",draft:"Your post has been saved as a draft."},draft:{published:"Your post has been published.",draft:"Your post has been saved as a draft."}}}},initialize:function(){var a=this;shortcut.add("Ctrl+Alt+P",function(){a.toggleStatus()}),shortcut.add("Ctrl+S",function(){a.updatePost()}),shortcut.add("Meta+S",function(){a.updatePost()}),this.listenTo(this.model,"change:status",this.render)},toggleStatus:function(){var a,b,c=this,d=Object.keys(this.statusMap),e=c.model,f=e.get("status"),g=d.indexOf(f);a=g+1>d.length-1?0:g+1,b=d[a],this.setActiveStatus(d[a],this.statusMap[b],f),this.savePost({status:d[a]}).then(function(){c.reportSaveSuccess(b,f)},function(a){c.reportSaveError(a,e,b,f)})},setActiveStatus:function(a,b,c){var d="published"===a&&"published"!==c,e="draft"===a&&"published"===c,f=d||e;$(".js-publish-splitbutton").removeClass(f?"splitbutton-save":"splitbutton-delete").addClass(f?"splitbutton-delete":"splitbutton-save"),$(".js-publish-button").attr("data-status",a).text(b).removeClass(f?"button-save":"button-delete").addClass(f?"button-delete":"button-save"),$(".js-publish-splitbutton > a").removeClass("active"),$(".js-publish-splitbutton .editor-options li").removeClass("active").filter(['li[data-set-status="',a,'"]'].join("")).addClass("active")},handleStatus:function(a){a&&a.preventDefault();var b=$(a.currentTarget).attr("data-set-status"),c=this.model.get("status");this.setActiveStatus(b,this.statusMap[b],c),$("body").find(".overlay:visible").fadeOut()},handlePostButton:function(a){a&&a.preventDefault();var b=$(a.currentTarget).attr("data-status");this.updatePost(b)},updatePost:function(a){var b=this,c=this.model,d=c.get("status");a=a||d,c.trigger("willSave"),this.savePost({status:a}).then(function(){b.reportSaveSuccess(a,d),b.render()},function(e){c.set({status:d}),b.setActiveStatus(a,b.statusMap[a],d),b.reportSaveError(e,c,a,d)})},savePost:function(a){var b,c=$(".js-publish-button"),d=function(a){return a.always(function(){c.prop("disabled",!1)}),a};return c.prop("disabled",!0),_.each(this.model.blacklist,function(a){this.model.unset(a)},this),b=this.model.save(_.extend({title:this.options.$title.val(),markdown:this.options.editor.value()},a)),d(b?b:$.Deferred().reject())},reportSaveSuccess:function(a,b){Ghost.notifications.clearEverything(),Ghost.notifications.addItem({type:"success",message:this.messageMap.success.post[b][a],status:"passive"}),this.options.editor.setDirty(!1)},reportSaveError:function(a,b,c,d){var e=this.messageMap.errors.post[d][c];a?e+=" "+Ghost.Views.Utils.getRequestErrorMessage(a):b.validationError&&(e+=" "+b.validationError),Ghost.notifications.clearEverything(),Ghost.notifications.addItem({type:"error",message:e,status:"passive"})},setStatusLabels:function(a){_.each(a,function(a,b){$('li[data-set-status="'+b+'"] > a').text(a)})},render:function(){var a=this.model.get("status");this.statusMap="published"!==a?this.createStatusMap:this.updateStatusMap,this.setStatusLabels(this.statusMap),this.setActiveStatus(a,this.statusMap[a],a)}})}(),function(){"use strict";Ghost.View.EditorTagWidget=Ghost.View.extend({events:{'keyup [data-input-behaviour="tag"]':"handleKeyup",'keydown [data-input-behaviour="tag"]':"handleKeydown",'keypress [data-input-behaviour="tag"]':"handleKeypress","click ul.suggestions li":"handleSuggestionClick","click .tags .tag":"handleTagClick","click .tag-label":"mobileTags"},keys:{UP:38,DOWN:40,ESC:27,ENTER:13,BACKSPACE:8},initialize:function(){var a=this,b=new Ghost.Collections.Tags;b.fetch().then(function(){a.allGhostTags=b.toJSON()}),this.listenTo(this.model,"willSave",this.completeCurrentTag,this)},render:function(){var a,b=this.model.get("tags"),c=$(".tags"),d=this;return c.empty(),b&&_.forEach(b,function(a){var b=$('<span class="tag" data-tag-id="'+a.id+'">'+_.escape(a.name)+"</span>");c.append(b),$("[data-tag-id="+a.id+"]")[0].scrollIntoView(!0)}),this.$suggestions=$("ul.suggestions").hide(),c.length&&(a=$(".tag-input").offset().left,$(".tag-blocks").css({left:a+"px"})),$(window).on("resize",d.resize).trigger("resize"),$(".tag-label").on("touchstart",function(){$(this).addClass("touch")}),this},mobileTags:function(){var a=window.matchMedia("(max-width: 400px)"),b=$("#publish-bar");a.matches&&(b.hasClass("extended-tags")?b.css("top","auto").animate({height:"40px"},300,"swing",function(){$(this).removeClass("extended-tags"),$(".tag-input").blur()}):b.animate({top:0,height:$(window).height()},300,"swing",function(){$(this).addClass("extended-tags"),$(".tag-input").focus()}),$(".tag-input").one("blur",function(){b.hasClass("extended-tags")&&!$(":hover").last().hasClass("tag")&&b.css("top","auto").animate({height:"40px"},300,"swing",function(){$(this).removeClass("extended-tags"),$(document.activeElement).blur(),document.documentElement.style.display="none",setTimeout(function(){document.documentElement.style.display="block"},0)})}),window.scrollTo(0,1))},showSuggestions:function(a,b){var c=b.toLowerCase(),d=this.findMatchingTags(c),e={left:a.position().left},f=5,g=c.replace(/[\-\/\\\^$*+?.()|\[\]{}]/g,"\\$&"),h=g.replace(/(\s+)/g,"(<[^>]+>)*$1(<[^>]+>)*"),i=new RegExp("("+h+")","i");this.$suggestions.css(e),this.$suggestions.html(""),d=_.first(d,f),d.length>0&&this.$suggestions.show(),_.each(d,function(a){var b,c;b=a.name.replace(i,function(a,b){return"<mark>"+_.escape(b)+"</mark>"}),b=b.replace(/(<mark>[^<>]*)((<[^>]+>)+)([^<>]*<\/mark>)/,function(a,b,c,d,e){return _.escape(b)+"</mark>"+_.escape(c)+"<mark>"+_.escape(e)}),c="<li data-tag-id='"+a.id+"' data-tag-name='"+_.escape(a.name)+"'><a href='#'>"+b+"</a></li>",this.$suggestions.append(c)},this)},handleKeyup:function(a){var b=$(a.currentTarget),c=$.trim(b.val());return a.keyCode===this.keys.UP?(a.preventDefault(),this.$suggestions.is(":visible")&&(0===this.$suggestions.children(".selected").length?this.$suggestions.find("li:last-child").addClass("selected"):this.$suggestions.children(".selected").removeClass("selected").prev().addClass("selected"))):a.keyCode===this.keys.DOWN?(a.preventDefault(),this.$suggestions.is(":visible")&&(0===this.$suggestions.children(".selected").length?this.$suggestions.find("li:first-child").addClass("selected"):this.$suggestions.children(".selected").removeClass("selected").next().addClass("selected"))):a.keyCode===this.keys.ESC?this.$suggestions.hide():c?this.showSuggestions(b,c):this.$suggestions.hide(),a.keyCode===this.keys.UP||a.keyCode===this.keys.DOWN?!1:void 0},handleKeydown:function(a){var b,c,d=$(a.currentTarget);a.keyCode!==this.keys.BACKSPACE||d.val()||(b=this.$(".tags").find(".tag").last(),b.remove(),c={id:b.data("tag-id"),name:b.text()},this.model.removeTag(c))},handleKeypress:function(a){var b,c,d,e=$(a.currentTarget),f=$.trim(e.val()),g=0===",".localeCompare(String.fromCharCode(a.keyCode||a.charCode));(a.keyCode===this.keys.ENTER||g)&&f&&(a.preventDefault(),c=this.$suggestions.children(".selected"),this.$suggestions.is(":visible")&&0!==c.length?(b={id:c.data("tag-id"),name:_.unescape(c.data("tag-name"))},d=this.hasTagBeenAdded(b.name),d||this.addTag(b)):(g&&(f=f.replace(/,/g,"")),d=this.hasTagBeenAdded(f),d||this.addTag({id:null,name:f})),e.val("").focus(),f="",this.$suggestions.hide())},completeCurrentTag:function(){var a,b=this.$(".tag-input"),c=b.val();a=this.hasTagBeenAdded(c),c.length>0&&!a&&this.addTag({id:null,name:c})},handleSuggestionClick:function(a){var b=$(a.currentTarget);a&&a.preventDefault(),this.addTag({id:b.data("tag-id"),name:_.unescape(b.data("tag-name"))})},handleTagClick:function(a){var b=$(a.currentTarget),c={id:b.data("tag-id"),name:b.text()};b.remove(),window.scrollTo(0,1),this.model.removeTag(c)},resize:_.throttle(function(){var a=$(".tags");$(window).width()>400?a.css("max-width",$("#entry-tags").width()-320):a.css("max-width","inherit")},50),findMatchingTags:function(a){var b,c=this;return this.allGhostTags?(a=a.toUpperCase(),b=_.filter(this.allGhostTags,function(b){var d,e;return d=-1!==b.name.toUpperCase().indexOf(a),e=c.hasTagBeenAdded(b.name),d&&!e})):[]},addTag:function(a){var b=$('<span class="tag" data-tag-id="'+a.id+'">'+_.escape(a.name)+"</span>");this.$(".tags").append(b),$(".tag").last()[0].scrollIntoView(!0),window.scrollTo(0,1),this.model.addTag(a),this.$(".tag-input").val("").focus(),this.$suggestions.hide()},hasTagBeenAdded:function(a){return _.some(this.model.get("tags"),function(b){return a.toUpperCase()===b.name.toUpperCase()})}})}(),function(){"use strict";var a;a=Ghost.View.extend({initialize:function(){this.addSubview(new Ghost.View.EditorTagWidget({el:this.$("#entry-tags"),model:this.model})).render(),this.addSubview(new Ghost.View.PostSettings({el:$("#entry-controls"),model:this.model})).render(),this.addSubview(new Ghost.View.EditorActionsWidget({el:this.$("#entry-actions"),model:this.model,$title:this.options.$title,editor:this.options.editor})).render()},render:function(){return this}}),Ghost.Views.Editor=Ghost.View.extend({events:{"click .markdown-help":"showHelp","blur #entry-title":"trimTitle",orientationchange:"orientationChange"},initialize:function(){this.$title=this.$("#entry-title"),this.$editor=this.$("#entry-markdown"),this.$title.val(this.model.get("title")).focus(),this.$editor.text(this.model.get("markdown")),this.editor=new Ghost.Editor.Main,this.addSubview(new a({el:"#publish-bar",model:this.model,$title:this.$title,editor:this.editor})).render(),this.listenTo(this.model,"change:title",this.renderTitle),this.listenTo(this.model,"change:id",this.handleIdChange),this.bindShortcuts(),$(".entry-markdown header, .entry-preview header").on("click",function(a){$(".entry-markdown, .entry-preview").removeClass("active"),$(a.currentTarget).closest("section").addClass("active")})},bindShortcuts:function(){var a=this;shortcut.add("Alt+Shift+Z",function(){$("body").toggleClass("zen")}),shortcut.add("Ctrl+Alt+C",function(){a.showHTML()})},trimTitle:function(){var a=this.$title.val(),b=$.trim(a);a!==b&&this.$title.val(b),this.model.set("title",b)},renderTitle:function(){this.$title.val(this.model.get("title"))},handleIdChange:function(a){this.editor.setDirty(!1),Backbone.history.navigate("/editor/"+a.id+"/")},orientationChange:function(){if(/iPhone/.test(navigator.userAgent)&&!/Opera Mini/.test(navigator.userAgent)){var a=document.activeElement,b=document.documentElement.style;a.blur(),b.display="none",setTimeout(function(){b.display="block",a.focus()},0)}},showEditorModal:function(a){this.addSubview(new Ghost.Views.Modal({model:{options:{close:!0,style:["wide"],animation:"fade"},content:a}}))},showHelp:function(){var a={template:"markdown",title:"Markdown Help"};this.showEditorModal(a)},showHTML:function(){var a={template:"copyToHTML",title:"Copied HTML"};this.showEditorModal(a)},render:function(){return this}})}(),function(){"use strict";Ghost.Views.Login=Ghost.View.extend({initialize:function(){this.render()},templateName:"login",events:{"submit #login":"submitHandler"},afterRender:function(){var a=this;this.$el.css({opacity:0}).animate({opacity:1},500,function(){a.$("[name='email']").focus()})},submitHandler:function(a){a.preventDefault();var b=this.$el.find(".email").val(),c=this.$el.find(".password").val(),d=Ghost.Views.Utils.getUrlVariables().r,e=[];validator.isEmail(b)||e.push("Invalid Email"),validator.isLength(c,0)||e.push("Please enter a password"),e.length?validator.handleErrors(e):$.ajax({url:Ghost.paths.subdir+"/ghost/signin/",type:"POST",headers:{"X-CSRF-Token":$("meta[name='csrf-param']").attr("content")},data:{email:b,password:c,redirect:d},success:function(a){window.location.href=a.redirect},error:function(a){Ghost.notifications.clearEverything(),Ghost.notifications.addItem({type:"error",message:Ghost.Views.Utils.getRequestErrorMessage(a),status:"passive"})}})}}),Ghost.Views.Signup=Ghost.View.extend({initialize:function(){this.submitted="no",this.render()},templateName:"signup",events:{"submit #signup":"submitHandler"},afterRender:function(){var a=this;this.$el.css({opacity:0}).animate({opacity:1},500,function(){a.$("[name='name']").focus()})},submitHandler:function(a){a.preventDefault();var b=this.$(".name").val(),c=this.$(".email").val(),d=this.$(".password").val(),e=[],f=this;validator.isLength(b,1)||e.push("Please enter a name."),validator.isEmail(c)||e.push("Please enter a correct email address."),validator.isLength(d,0)||e.push("Please enter a password"),validator.equals(this.submitted,"no")||e.push("Ghost is signing you up. Please wait..."),e.length?validator.handleErrors(e):(this.submitted="yes",$.ajax({url:Ghost.paths.subdir+"/ghost/signup/",type:"POST",headers:{"X-CSRF-Token":$("meta[name='csrf-param']").attr("content")},data:{name:b,email:c,password:d},success:function(a){window.location.href=a.redirect},error:function(a){f.submitted="no",Ghost.notifications.clearEverything(),Ghost.notifications.addItem({type:"error",message:Ghost.Views.Utils.getRequestErrorMessage(a),status:"passive"})}}))}}),Ghost.Views.Forgotten=Ghost.View.extend({initialize:function(){this.render()},templateName:"forgotten",events:{"submit #forgotten":"submitHandler"},afterRender:function(){var a=this;this.$el.css({opacity:0}).animate({opacity:1},500,function(){a.$("[name='email']").focus()})},submitHandler:function(a){a.preventDefault();var b=this.$el.find(".email").val(),c=[];validator.isEmail(b)||c.push("Please enter a correct email address."),c.length?validator.handleErrors(c):$.ajax({url:Ghost.paths.subdir+"/ghost/forgotten/",type:"POST",headers:{"X-CSRF-Token":$("meta[name='csrf-param']").attr("content")},data:{email:b},success:function(a){window.location.href=a.redirect},error:function(a){Ghost.notifications.clearEverything(),Ghost.notifications.addItem({type:"error",message:Ghost.Views.Utils.getRequestErrorMessage(a),status:"passive"})}})}}),Ghost.Views.ResetPassword=Ghost.View.extend({templateName:"reset",events:{"submit #reset":"submitHandler"},initialize:function(a){a=a||{},this.token=a.token,this.render()},afterRender:function(){var a=this;this.$el.css({opacity:0}).animate({opacity:1},500,function(){a.$("[name='newpassword']").focus()})},submitHandler:function(a){a.preventDefault();var b=this,c=this.$('input[name="newpassword"]').val(),d=this.$('input[name="ne2password"]').val();return c!==d?(Ghost.notifications.clearEverything(),void Ghost.notifications.addItem({type:"error",message:"Your passwords do not match.",status:"passive"})):(this.$("input, button").prop("disabled",!0),$.ajax({url:Ghost.paths.subdir+"/ghost/reset/"+this.token+"/",type:"POST",headers:{"X-CSRF-Token":$("meta[name='csrf-param']").attr("content")},data:{newpassword:c,ne2password:d},success:function(a){window.location.href=a.redirect},error:function(a){b.$("input, button").prop("disabled",!1),Ghost.notifications.clearEverything(),Ghost.notifications.addItem({type:"error",message:Ghost.Views.Utils.getRequestErrorMessage(a),status:"passive"})}}),!1)}})}(),function(){"use strict";var a=["DD MMM YY HH:mm","DD MMM YYYY HH:mm","DD/MM/YY HH:mm","DD/MM/YYYY HH:mm","DD-MM-YY HH:mm","DD-MM-YYYY HH:mm","YYYY-MM-DD HH:mm"],b="DD MMM YY @ HH:mm";Ghost.View.PostSettings=Ghost.View.extend({events:{"blur  .post-setting-slug":"editSlug","click .post-setting-slug":"selectSlug","blur  .post-setting-date":"editDate","click .post-setting-static-page":"toggleStaticPage","click .delete":"deletePost"},initialize:function(){this.model&&(this.listenTo(this.model,"change:id",this.render),this.listenTo(this.model,"change:title",this.updateSlugPlaceholder),this.listenTo(this.model,"change:published_at",this.updatePublishedDate))},render:function(){var a=this.model?this.model.get("slug"):"",c=this.model?this.model.get("published_at"):"Not Published",d=this.$(".post-setting-date"),e=this.$(".post-setting-slug");e.val(a),this.model&&this.model.get("page")&&$(".post-setting-static-page").prop("checked",this.model.get("page")),this.model&&this.model.get("published_at")?(c=moment(c).format(b),d.attr("placeholder","")):d.attr("placeholder",moment().format(b)),this.model&&this.model.get("id")&&(this.$(".post-setting-page").removeClass("hidden"),this.$(".delete").removeClass("hidden")),void 0===this.model.id?this.$el.addClass("unsaved"):this.$el.removeClass("unsaved"),d.val(c)},updateSlugPlaceholder:function(){var a=this.model.get("title"),b=this.$(".post-setting-slug");return a?void $.ajax({url:Ghost.paths.apiRoot+"/posts/slug/"+encodeURIComponent(a)+"/",success:function(a){b.attr("placeholder",a)}}):void b.attr("placeholder","")},selectSlug:function(a){a.currentTarget.select()},editSlug:_.debounce(function(a){a.preventDefault();var b=this,c=b.model.get("slug"),d=a.currentTarget,e=d.value,f=d.placeholder;return e=_.isEmpty(e)&&f?f:e,void 0===b.model.id?void this.model.set({slug:e}):c===e?void(d.value=void 0===c?"":c):void this.model.save({slug:e},{success:function(a){d.value=a.get("slug"),Ghost.notifications.addItem({type:"success",message:"Permalink successfully changed to <strong>"+a.get("slug")+"</strong>.",status:"passive"})},error:function(a,b){d.value=a.previous("slug"),Ghost.notifications.addItem({type:"error",message:Ghost.Views.Utils.getRequestErrorMessage(b),status:"passive"})}})},500),updatePublishedDate:function(){var a=this.model.get("published_at")?moment(this.model.get("published_at")).format(b):"",c=this.$(".post-setting-date");a&&c.val()!==a&&c.val(a)},editDate:_.debounce(function(c){c.preventDefault();var d,e,f=this,g="",h=f.model.get("published_at")?moment(f.model.get("published_at")).format(b):"",i=c.currentTarget,j=i.value;if(j)return j&&!j.slice(-5).match(/\d+:\d\d/)&&(j+=" 12:00"),e=moment(j,a),h&&(h.slice(-5).match(/\d+:\d\d/)||(h+=" 12:00"),d=moment(h,a),0===j.length||d.isSame(e))?void(i.value=d.format(b)):(e.isValid()||(g="Published Date must be a valid date with format: DD MMM YY @ HH:mm (e.g. 6 Dec 14 @ 15:00)"),e.diff(new Date,"h")>0&&(g="Published Date cannot currently be in the future."),g.length?(Ghost.notifications.addItem({type:"error",message:g,status:"passive"}),void(i.value=d?d.format(b):"")):void 0===f.model.id?void this.model.set({published_at:e.toDate()}):void this.model.save({published_at:e.toDate()},{success:function(a){i.value=moment(a.get("published_at")).format(b),Ghost.notifications.addItem({type:"success",message:"Publish date successfully changed to <strong>"+i.value+"</strong>.",status:"passive"})},error:function(a,c){i.value=d?d.format(b):"",Ghost.notifications.addItem({type:"error",message:Ghost.Views.Utils.getRequestErrorMessage(c),status:"passive"})}}))},500),toggleStaticPage:_.debounce(function(a){var b=$(a.currentTarget),c=b.prop("checked");return void 0===this.model.id?void this.model.set({page:c}):void this.model.save({page:c},{success:function(){b.prop("checked",c),Ghost.notifications.addItem({type:"success",message:"Successfully converted "+(c?"to static page":"to post")+".",status:"passive"})},error:function(a,c){b.prop("checked",a.previous("page")),Ghost.notifications.addItem({type:"error",message:Ghost.Views.Utils.getRequestErrorMessage(c),status:"passive"})}})},500),deletePost:function(a){a.preventDefault();var b=this;void 0!==this.model.id&&this.addSubview(new Ghost.Views.Modal({model:{options:{close:!1,confirm:{accept:{func:function(){b.model.destroy({wait:!0}).then(function(){window.location.pathname.indexOf("editor")>-1&&(window.location=Ghost.paths.subdir+"/ghost/content/"),Ghost.notifications.addItem({type:"success",message:"Your post has been deleted.",status:"passive"})},function(){Ghost.notifications.addItem({type:"error",message:"Your post could not be deleted. Please try again.",status:"passive"})})},text:"Delete",buttonClass:"button-delete"},reject:{func:function(){return!0},text:"Cancel",buttonClass:"button"}},type:"action",style:["wide","centered"],animation:"fade"},content:{template:"blank",title:"Are you sure you want to delete this post?",text:"<p>This is permanent! No backups, no restores, no magic undo button. <br /> We warned you, ok?</p>"}}}))}})}(),function(){"use strict";var a={};Ghost.Views.Settings=Ghost.View.extend({initialize:function(b){$(".settings-content").removeClass("active"),this.sidebar=new a.Sidebar({el:".settings-sidebar",pane:b.pane,model:this.model}),this.addSubview(this.sidebar),this.listenTo(Ghost.router,"route:settings",this.changePane)},changePane:function(a){a&&this.sidebar.showContent(a)}}),a.Sidebar=Ghost.View.extend({initialize:function(a){this.render(),this.menu=this.$(".settings-menu"),"true"!==$(this.el).attr("data-apps")&&this.menu.find(".apps").hide(),this.showContent(a.pane)},models:{},events:{"click .settings-menu li":"switchPane"},switchPane:function(a){a.preventDefault();var b=$(a.currentTarget),c=b.find("a").attr("href").substring(1);this.showContent(c)},showContent:function(b){var c,d=this;Ghost.router.navigate("/settings/"+b+"/"),Ghost.trigger("urlchange"),this.pane&&b===this.pane.id||(_.result(this.pane,"destroy"),this.setActive(b),this.pane=new a[b]({el:".settings-content"}),this.models.hasOwnProperty(this.pane.options.modelType)?(c=this.models[this.pane.options.modelType],d.renderPane(c)):(c=this.models[this.pane.options.modelType]=new Ghost.Models[this.pane.options.modelType],c.fetch().then(function(){d.renderPane(c)
})))},renderPane:function(a){this.pane.model=a,this.pane.render()},setActive:function(a){this.menu.find("li").removeClass("active"),this.menu.find("a[href=#"+a+"]").parent().addClass("active")},templateName:"settings/sidebar"}),a.Pane=Ghost.View.extend({options:{modelType:"Settings"},destroy:function(){this.$el.removeClass("active"),this.undelegateEvents()},render:function(){this.$el.hide(),Ghost.View.prototype.render.call(this),this.$el.fadeIn(300)},afterRender:function(){this.$el.attr("id",this.id),this.$el.addClass("active")},saveSuccess:function(){Ghost.notifications.clearEverything(),Ghost.notifications.addItem({type:"success",message:"Saved",status:"passive"})},saveError:function(a,b){Ghost.notifications.clearEverything(),Ghost.notifications.addItem({type:"error",message:Ghost.Views.Utils.getRequestErrorMessage(b),status:"passive"})},validationError:function(a){Ghost.notifications.clearEverything(),Ghost.notifications.addItem({type:"error",message:a,status:"passive"})}}),a.general=a.Pane.extend({id:"general",events:{"click .button-save":"saveSettings","click .js-modal-logo":"showLogo","click .js-modal-cover":"showCover"},saveSettings:function(){var a=this,b=this.$("#blog-title").val(),c=this.$("#blog-description").val(),d=this.$("#email-address").val(),e=this.$("#postsPerPage").val(),f=this.$("#permalinks").is(":checked")?"/:year/:month/:day/:slug/":"/:slug/",g=[];validator.isLength(b,0,150)||g.push({message:"Title is too long",el:$("#blog-title")}),validator.isLength(c,0,200)||g.push({message:"Description is too long",el:$("#blog-description")}),validator.isEmail(d)&&validator.isLength(d,0,254)||g.push({message:"Please supply a valid email address",el:$("#email-address")}),(!validator.isInt(e)||e>1e3)&&g.push({message:"Please use a number less than 1000",el:$("postsPerPage")}),(!validator.isInt(e)||0>e)&&g.push({message:"Please use a number greater than 0",el:$("postsPerPage")}),g.length?validator.handleErrors(g):this.model.save({title:b,description:c,email:d,postsPerPage:e,activeTheme:this.$("#activeTheme").val(),permalinks:f},{success:this.saveSuccess,error:this.saveError}).then(function(){a.render()})},showLogo:function(a){a.preventDefault();var b=this.model.toJSON();this.showUpload("logo",b.logo)},showCover:function(a){a.preventDefault();var b=this.model.toJSON();this.showUpload("cover",b.cover)},showUpload:function(a,b){var c=this,d=new Ghost.Models.uploadModal({key:a,src:b,id:this.id,accept:{func:function(){var b={};return b[a]=this.$(".js-upload-url").val()?this.$(".js-upload-url").val():this.$(".js-upload-target").attr("src"),c.model.set(b),c.saveSettings(),!0},buttonClass:"button-save right",text:"Save"}});this.addSubview(new Ghost.Views.Modal({model:d}))},templateName:"settings/general",afterRender:function(){var b=this;this.$("#permalinks").prop("checked","/:slug/"!==this.model.get("permalinks")),this.$(".js-drop-zone").upload(),Countable.live(document.getElementById("blog-description"),function(a){var c=b.$(".description-container .word-count");c.css(a.all>180?{color:"#e25440"}:{color:"#9E9D95"}),c.text(200-a.all)}),a.Pane.prototype.afterRender.call(this)}}),a.user=a.Pane.extend({templateName:"settings/user-profile",id:"user",options:{modelType:"User"},events:{"click .button-save":"saveUser","click .button-change-password":"changePassword","click .js-modal-cover":"showCover","click .js-modal-image":"showImage","keyup .user-profile":"handleEnterKeyOnForm"},showCover:function(a){a.preventDefault();var b=this.model.toJSON();this.showUpload("cover",b.cover)},showImage:function(a){a.preventDefault();var b=this.model.toJSON();this.showUpload("image",b.image)},showUpload:function(a,b){var c=this,d=new Ghost.Models.uploadModal({key:a,src:b,id:this.id,accept:{func:function(){var b={};return b[a]=this.$(".js-upload-url").val()?this.$(".js-upload-url").val():this.$(".js-upload-target").attr("src"),c.model.set(b),c.saveUser(b),!0},buttonClass:"button-save right",text:"Save"}});this.addSubview(new Ghost.Views.Modal({model:d}))},handleEnterKeyOnForm:function(a){if(13===a.which){var b=$(a.target);if(!b.is("textarea"))return b.is("input[type=password]")?this.changePassword(a):(a.preventDefault(),this.saveUser(a),!1)}},saveUser:function(){var a=this,b=this.$("#user-name").val(),c=this.$("#user-email").val(),d=this.$("#user-location").val(),e=this.$("#user-website").val(),f=this.$("#user-bio").val(),g=[];validator.isLength(b,0,150)||g.push({message:"Name is too long",el:$("#user-name")}),validator.isLength(f,0,200)||g.push({message:"Bio is too long",el:$("#user-bio")}),validator.isEmail(c)||g.push({message:"Please supply a valid email address",el:$("#user-email")}),validator.isLength(d,0,150)||g.push({message:"Location is too long",el:$("#user-location")}),e.length&&(validator.isURL(e)&&validator.isLength(e,0,2e3)||g.push({message:"Please use a valid url",el:$("#user-website")})),g.length?validator.handleErrors(g):this.model.save({name:b,email:c,location:d,website:e,bio:f},{success:this.saveSuccess,error:this.saveError}).then(function(){a.render()})},changePassword:function(a){a.preventDefault();var b=this,c=this.$("#user-password-old").val(),d=this.$("#user-password-new").val(),e=this.$("#user-new-password-verification").val(),f=[];validator.equals(d,e)||f.push("Your new passwords do not match"),validator.isLength(d,8)||f.push("Your password is not long enough. It must be at least 8 characters long."),f.length?validator.handleErrors(f):$.ajax({url:Ghost.paths.subdir+"/ghost/changepw/",type:"POST",headers:{"X-CSRF-Token":$("meta[name='csrf-param']").attr("content")},data:{password:c,newpassword:d,ne2password:e},success:function(a){Ghost.notifications.addItem({type:"success",message:a.msg,status:"passive",id:"success-98"}),b.$("#user-password-old, #user-password-new, #user-new-password-verification").val("")},error:function(a){Ghost.notifications.addItem({type:"error",message:Ghost.Views.Utils.getRequestErrorMessage(a),status:"passive"})}}).then(function(){b.render()})},afterRender:function(){var b=this;Countable.live(document.getElementById("user-bio"),function(a){var c=b.$(".bio-container .word-count");c.css(a.all>180?{color:"#e25440"}:{color:"#9E9D95"}),c.text(200-a.all)}),a.Pane.prototype.afterRender.call(this)}}),a.apps=a.Pane.extend({id:"apps",events:{"click .js-button-activate":"activateApp","click .js-button-deactivate":"deactivateApp"},beforeRender:function(){this.availableApps=this.model.toJSON().availableApps},activateApp:function(a){var b=$(a.currentTarget);b.removeClass("button-add").addClass("button js-button-active").text("Working"),this.saveStates()},deactivateApp:function(a){var b=$(a.currentTarget);b.removeClass("button-delete js-button-active").addClass("button").text("Working"),this.saveStates()},saveStates:function(){var a=this.$el.find(".js-apps .js-button-active"),b=[],c=this;_.each(a,function(a){b.push($(a).data("app"))}),this.model.save({activeApps:JSON.stringify(b)},{success:this.saveSuccess,error:this.saveError}).then(function(){c.render()})},saveSuccess:function(){Ghost.notifications.addItem({type:"success",message:"Active applications updated.",status:"passive",id:"success-1100"})},saveError:function(a){Ghost.notifications.addItem({type:"error",message:Ghost.Views.Utils.getRequestErrorMessage(a),status:"passive"})},templateName:"settings/apps"})}(),function(){"use strict";Ghost.Router=Backbone.Router.extend({routes:{"":"blog","content/":"blog","settings(/:pane)/":"settings","editor(/:id)/":"editor","debug/":"debug","register/":"register","signup/":"signup","signin/":"login","forgotten/":"forgotten","reset/:token/":"reset"},signup:function(){Ghost.currentView=new Ghost.Views.Signup({el:".js-signup-box"})},login:function(){Ghost.currentView=new Ghost.Views.Login({el:".js-login-box"})},forgotten:function(){Ghost.currentView=new Ghost.Views.Forgotten({el:".js-forgotten-box"})},reset:function(a){Ghost.currentView=new Ghost.Views.ResetPassword({el:".js-reset-box",token:a})},blog:function(){var a=new Ghost.Collections.Posts;NProgress.start(),a.fetch({data:{status:"all",staticPages:"all",include:"author"}}).then(function(){Ghost.currentView=new Ghost.Views.Blog({el:"#main",collection:a}),NProgress.done()})},settings:function(a){return a?void(Ghost.currentView&&Ghost.currentView instanceof Ghost.Views.Settings||(Ghost.currentView=new Ghost.Views.Settings({el:"#main",pane:a}))):void this.navigate("/settings/general/",{trigger:!0,replace:!0})},editor:function(a){var b=new Ghost.Models.Post;b.urlRoot=Ghost.paths.apiRoot+"/posts",a?(b.id=a,b.fetch({data:{status:"all",include:"tags"}}).then(function(){Ghost.currentView=new Ghost.Views.Editor({el:"#main",model:b})})):Ghost.currentView=new Ghost.Views.Editor({el:"#main",model:b})},debug:function(){Ghost.currentView=new Ghost.Views.Debug({el:"#main"})}})}();